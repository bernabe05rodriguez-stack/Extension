var pro_close_img_src=chrome.runtime.getURL("logo/pro-closeBtn.png"),pro_free_trial_src=chrome.runtime.getURL("logo/pro-free-trial.png"),pro_advance_promo_src=chrome.runtime.getURL("logo/pro_advance_promo.png"),pro_success_gif=chrome.runtime.getURL("logo/pro-success.gif"),pro_recommend_tick=chrome.runtime.getURL("logo/pro-tickmark.png"),pro_export_chat_contacts_img_src=chrome.runtime.getURL("logo/pro-export-unsaved-contacts.png"),pro_export_img_src=chrome.runtime.getURL("logo/pro-export.png"),pro_export_contacts_text_src=chrome.runtime.getURL("logo/pro-export-contact.svg"),pro_email_icon_src=chrome.runtime.getURL("logo/pro-email.png"),pro_error_icon_src=chrome.runtime.getURL("logo/pro-error.png"),pro_help_icon_src=chrome.runtime.getURL("logo/pro-help.png"),pro_read_icon_src=chrome.runtime.getURL("logo/pro-read.png"),pro_wall_clock_white_icon=chrome.runtime.getURL("logo/pro-wall-clock-white.png"),pro_smile_icon=chrome.runtime.getURL("logo/pro-smile.png"),logo_img=chrome.runtime.getURL("logo/pro-logo-img.png"),large_logo_img=chrome.runtime.getURL("logo/large.png"),medium_logo_img=chrome.runtime.getURL("logo/pro-medium.png"),logo_text=chrome.runtime.getURL("logo/pro-logo-text.png"),logo_text_light=chrome.runtime.getURL("logo/pro-logo-text-light.png"),pro_arrow_left=chrome.runtime.getURL("logo/pro-arrow-left.png"),pro_arrow_right=chrome.runtime.getURL("logo/pro-arrow-right.png"),pro_bulb_icon=chrome.runtime.getURL("logo/pro-lightbulb.png"),pro_how_to_use1=chrome.runtime.getURL("logo/pro-how-to-use-1.gif"),pro_how_to_use2=chrome.runtime.getURL("logo/pro-how-to-use-2.gif"),pro_how_to_use3=chrome.runtime.getURL("logo/pro-how-to-use-3.gif"),pro_man_thinking=chrome.runtime.getURL("logo/pro-man-thinking.png"),pro_cross_icon_src=chrome.runtime.getURL("logo/pro-close-1.png"),pro_check_icon_src=chrome.runtime.getURL("logo/pro-check-mark.png"),pro_eye_visible=chrome.runtime.getURL("logo/pro-eye-visible.png"),pro_eye_hidden=chrome.runtime.getURL("logo/pro-eye-hidden.png"),pro_pause_icon_src=chrome.runtime.getURL("logo/pro-pause_logo.png"),pro_alarm_clock=chrome.runtime.getURL("logo/pro_alarm_clock.png"),pro_yellow_star=chrome.runtime.getURL("logo/pro_yellow-star.png"),pro_multiple_users_icon=chrome.runtime.getURL("logo/pro_multiple-users.png"),pro_down_arrow=chrome.runtime.getURL("logo/pro-down-arrow.png"),pro_drag_icon=chrome.runtime.getURL("logo/pro-drag-icon.png"),pro_delete_icon=chrome.runtime.getURL("logo/pro-delete-icon.png"),pro_attach_icon=chrome.runtime.getURL("logo/pro_attach_symbol.png"),pro_edit_icon=chrome.runtime.getURL("logo/pro-edit_icon.png"),pro_logo_new=chrome.runtime.getURL("logo/pro-new-logo.png");let link=document.createElement("link");link.rel="stylesheet",link.href="https://fonts.googleapis.com/css2?family=Palanquin+Dark:wght@400;500;700&family=PT+Sans+Caption&family=Reem+Kufi+Ink&display=swap",document.head.appendChild(link);let my_number=null,logged_in_user=null,plan_type="Advance",last_plan_type="Expired",plan_duration="",expiry_date=null;var rows=null,notifications_hash={},stop=!1,pause=!1,groupIdToName={},contactIdToName={};let isProfile=!1;var cancelDelay,messages=["Hello! how can we help you?","Hello!","Thank you for using service!"],total_messages=0,totalConvertedSize=0,imageData=null,reload_quick_reply_div=!0,location_info={name:"international",name_code:"US",currency:"USD",default:!0},init_store_type=null,whatsapp_version=null,extension_version=chrome.runtime.getManifest().version;let premiumUsageObject={lastDate:(new Date).getDate(),lastMonth:(new Date).getMonth(),attachment:!1,customisation:!1,groupContactExport:!1,quickReplies:!1,caption:!1,stop:!1,timeGap:!1,batching:!1};function setPremiumUsageObject(){chrome.storage.local.get(["premiumUsageObject"],function(result){if(void 0!==result.premiumUsageObject){const day=result.premiumUsageObject.lastDate,presentDay=(new Date).getDate();let diffInDays;diffInDays=presentDay>=day?presentDay-day:30-day+presentDay,diffInDays>=14&&chrome.storage.local.set({premiumUsageObject})}else chrome.storage.local.set({premiumUsageObject})})}function injectMessageListner(event){if(event.source!=window||!event.data.type)return;let message_type=event.data.type,message_payload=event.data.payload;switch(message_payload&&(message_payload.error?trackError(message_type,message_payload.error):message_type.includes("send")&&trackSuccess(message_type+"_success")),message_type){case"get_init_store_type":(init_store_type=localStorage.getItem("pro-sender::init_store_type"))&&init_store_type==message_payload||(init_store_type=message_payload,localStorage.setItem("pro-sender::init_store_type",init_store_type),trackSystemEvent("init_store_type",init_store_type));break;case"get_whatsapp_version":(whatsapp_version=localStorage.getItem("pro-sender::whatsapp-version"))&&whatsapp_version==message_payload||(whatsapp_version=message_payload,localStorage.setItem("pro-sender::whatsapp-version",whatsapp_version),trackSystemEvent("whatsapp_version",whatsapp_version));break;case"get_all_groups":setGroupDataToLocalStorage(message_payload);break;case"get_all_contacts":setContactDataToLocalStorage(message_payload);break;case"get_all_labels":setLabelDataToLocalStorage(message_payload);break;case"send_message_to_number":resolveSendMessageToNumber(message_payload);break;case"send_message_to_number_new_error":rejectSendMessageToNumber(message_payload);break;case"send_message_to_group":case"send_message_to_group_error":resolveSendMessageToGroup(message_payload);break;case"send_attachments_to_number":case"send_attachments_to_number_error":resolveSendAttachmentsToNumber(message_payload);break;case"send_attachments_to_group":case"send_attachments_to_grpup_error":resolveSendAttachmentsToGroup(message_payload);break;case"incoming_message":message_payload&&message_payload.body&&processChatbotMessageFromStore(message_payload)}}function download_group_contacts(){let conv_header=getDocumentElement("conversation_header");if(!conv_header)return;let conv_msg_div=getDocumentElement("conversation_message_div");if(!conv_msg_div||!conv_msg_div.dataset.id.includes("@g.us"))return;let group_id=conv_msg_div.dataset.id.split("_")[1],download_group_btn=document.createElement("div"),export_contacts_text=document.createElement("span");export_contacts_text.classList.add("export_contacts_text");let export_contacts_text_class="",groupTitleElement=getDocumentElement("conversation_title_div"),groupTitle=groupTitleElement.innerText;document.body.classList.contains("dark")&&(export_contacts_text_class="export_gif_bright"),export_contacts_text.innerHTML=` <img class="export_gif ${export_contacts_text_class}" src=${pro_export_contacts_text_src} />`,download_group_btn.id="download_group_btn",download_group_btn.className="CtaBtn shimmer",download_group_btn.innerHTML=`<img src=${pro_export_img_src} />`,download_group_btn.appendChild(export_contacts_text),chrome.storage.local.get(["coeu862","ldeu863","groupDataForShimmer"],function(result){let today=(new Date).toDateString(),coeu862=result.coeu862||0,ldeu863=result.ldeu863||"",groupDataForShimmer=result.groupDataForShimmer||[{}];if(today!==ldeu863&&(ldeu863=today,coeu862++,chrome.storage.local.set({coeu862,ldeu863})),coeu862<=5){let groupIndex=groupDataForShimmer.findIndex(group=>group.groupName===groupTitle);-1!==groupIndex?groupDataForShimmer[groupIndex].lastShimmerDay!==today&&groupDataForShimmer[groupIndex].shimmerCount<=5?(groupDataForShimmer[groupIndex].lastShimmerDay=today,groupDataForShimmer[groupIndex].shimmerCount=groupDataForShimmer[groupIndex].shimmerCount+1,chrome.storage.local.set({groupDataForShimmer})):(download_group_btn.classList.remove("shimmer"),export_contacts_text.innerHTML="Export Contacts"):(groupDataForShimmer.push({groupName:groupTitle,lastShimmerDay:today,shimmerCount:1}),chrome.storage.local.set({groupDataForShimmer})),setTimeout(()=>{download_group_btn.classList.remove("shimmer"),export_contacts_text.innerHTML="Export Contacts"},5e3)}else download_group_btn.classList.remove("shimmer"),export_contacts_text.innerHTML="Export Contacts"}),conv_header.insertBefore(download_group_btn,conv_header.childNodes[2]);let groupTitleParent=groupTitleElement?.parentElement?.parentElement;groupTitleElement&&(groupTitleParent.style.overflowX="hidden"),download_group_btn.addEventListener("click",function(){isPremiumFeatureAvailable()?(window.dispatchEvent(new CustomEvent("PROS::export-group",{detail:{groupId:group_id}})),trackButtonClick("download_group_contacts_premium")):premium_reminder("download_group_contacts","Premium"),chrome.storage.local.get(["premiumUsageObject"],function(result){if(void 0!==result.premiumUsageObject){let updatedPremiumUsageObject={...result.premiumUsageObject,groupContactExport:!0};chrome.storage.local.set({premiumUsageObject:updatedPremiumUsageObject})}}),trackButtonClick("download_group_contacts")})}function profile_header_buttons(){const profile_header=getDocumentElement("profile_header");if(!profile_header)return;const profile_header_buttons_div=document.createElement("div");profile_header_buttons_div.id="profile_header_buttons_div";const profile_header_buttons_list=profile_header.children[0];profile_header_buttons_list.insertBefore(profile_header_buttons_div,profile_header_buttons_list.children[0]),add_profile_header_btn("pro_profile","Profile - Pro Sender",medium_logo_img,pro_profile_popup),add_profile_header_btn("blur_contacts","Blur chat, contact name and profile picture - Pro Sender",pro_eye_hidden,show_blur_dropdown),add_profile_header_btn("download_unsaved_contacts","Export unsaved contacts - Pro Sender",pro_export_chat_contacts_img_src,download_unsaved_contacts);const new_chat_btn=getDocumentElement("new_chat_btn");new_chat_btn&&!new_chat_btn.classList.contains("CtaBtn")&&new_chat_btn.classList.add("CtaBtn");getDocumentElement("new_chat_parent")&&(new_chat_btn.title="",handleShowTooltip({query:DOCUMENT_ELEMENT_SELECTORS.new_chat_parent[0],text:"New chat",bottom:"-30px"}))}function add_profile_header_btn(btn_id,btn_title,btn_image=null,on_click){const profile_header_buttons_div=document.querySelector("#profile_header_buttons_div");if(!profile_header_buttons_div)return;if(document.querySelector(`#${btn_id}`))return;const btn=document.createElement("div");btn.id=btn_id,btn.classList.add("profile_header_button"),btn.innerHTML=`<img src=${btn_image} class='${btn_id}_icon CtaBtn' alt='${btn_id}'>`,btn.addEventListener("click",on_click),profile_header_buttons_div.appendChild(btn),handleShowTooltip({query:`#${btn_id}`,text:btn_title,bottom:"-30px"})}function download_unsaved_contacts(){const parentDiv=document.querySelector("#profile_header_buttons_div");if(!parentDiv)return void console.warn("Profile header buttons div not found");if(document.querySelector("#export_options"))return void parentDiv.removeChild(document.querySelector("#export_options"));let mainDiv=document.createElement("div");mainDiv.id="export_options",mainDiv.innerHTML=`\n  <div id="saved_contacts" class="export_option">\n      <button class="contacts_btn">\n          <img class="contacts_img" src="${pro_export_img_src}">\n      </button> \n      Download saved contacts\n  </div>\n  <div id="unsaved_contacts" class="export_option">\n      <button class="contacts_btn">\n          <img class="contacts_img" src="${pro_export_chat_contacts_img_src}">\n      </button> \n      Download chat contacts\n  </div>    \n  `,parentDiv.append(mainDiv),document.getElementById("saved_contacts").addEventListener("click",()=>{isAdvanceFeatureAvailable()?(window.dispatchEvent(new CustomEvent("PROS::export-saved-contacts",{detail:{type:"Advance"}})),trackButtonClick("download_saved_contacts_premium")):window.dispatchEvent(new CustomEvent("PROS::export-saved-contacts",{detail:{type:"Expired"}})),chrome.storage.local.get(["premiumUsageObject"],result=>{if(void 0!==result.premiumUsageObject){let updatedPremiumUsageObject={...result.premiumUsageObject,downloadSavedContacts:!0};chrome.storage.local.set({premiumUsageObject:updatedPremiumUsageObject})}}),mainDiv.remove()}),document.getElementById("unsaved_contacts").addEventListener("click",()=>{isAdvanceFeatureAvailable()?(window.dispatchEvent(new CustomEvent("PROS::export-unsaved-contacts",{detail:{type:"Advance"}})),trackButtonClick("download_unsaved_contacts_premium")):window.dispatchEvent(new CustomEvent("PROS::export-unsaved-contacts",{detail:{type:"Expired"}})),chrome.storage.local.get(["premiumUsageObject"],result=>{if(void 0!==result.premiumUsageObject){let updatedPremiumUsageObject={...result.premiumUsageObject,downloadUnsavedContacts:!0};chrome.storage.local.set({premiumUsageObject:updatedPremiumUsageObject})}}),mainDiv.remove()}),trackButtonClick("download_contacts")}async function showBuyPremiumButtons(){let pricing_data;if(pricing_data="FreeTrial"==last_plan_type||"FreeTrial"==plan_type?PRICING_DATA.free_trial_expired:PRICING_DATA.premium_expired,!pricing_data)return"";let{name:country_name,name_code:country_code,currency:country_currency}=location_info;country_name=Object.keys(COUNTRY_WITH_SPECIFIC_PRICING).includes(country_code)?COUNTRY_WITH_SPECIFIC_PRICING[country_code]:"international";let advancePrice=pricing_data.advance_price[country_name],basicPrice=pricing_data.basic_price[country_name],advanceConvertedPrice=await convertPriceToLocale(advancePrice.substring(1)),basicConvertedPrice=await convertPriceToLocale(basicPrice.substring(1));if("FreeTrial"==plan_type||"Expired"==plan_type&&"FreeTrial"==last_plan_type)return getFreeTrialButtonHtml();if("Expired"!=plan_type){return'<div style="width:100%;display:flex;justify-content:center;align-items:center;">\n                <a href="" target="_blank" style="color:#009a88;font-size:12px;text-decoration:underline;">Purchase for multiple users</a>\n            </div>'}if("Basic"==last_plan_type){let{basicButtonHtml,advanceButtonHtml}=await getBasicPremiumExpiredButton(basicPrice,basicConvertedPrice,advancePrice,advanceConvertedPrice,"");return basicButtonHtml+advanceButtonHtml}if("Advance"==last_plan_type){return await getAdvancePremiumExpiredButton(advancePrice,advanceConvertedPrice,"")}}async function pro_profile_popup(){const parentDiv=document.querySelector("#profile_header_buttons_div");if(!parentDiv)return;if(document.querySelector("#pro_profile_popup"))return void parentDiv.removeChild(document.querySelector("#pro_profile_popup"));const mainDiv=document.createElement("div");mainDiv.id="pro_profile_popup",mainDiv.classList.add("pro_profile_main"),mainDiv.dir="ltr";const topSection=document.createElement("div");topSection.classList.add("pro_profile_top"),topSection.innerHTML=`\n    <div class="pro_profile_cross" id="close_pro_profile_popup">\n      <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M405 136.798L375.202 107 256 226.202 136.798 107 107 136.798 226.202 256 107 375.202 136.798 405 256 285.798 375.202 405 405 375.202 285.798 256z"></path></svg>\n    </div>\n    <div class="pro_profile_logo">\n         <div class="pro_profile_text">\n             <img src="${logo_text_light}" alt="">\n         </div>\n    </div>`;const bodySection=document.createElement("div");bodySection.classList.add("pro_profile_body");let bodyHtml=await new Promise(resolve=>{chrome.storage.local.get(["my_number","plan_type","customer_name","customer_email","expiry_date"],async function(result){let bodyHtml="";const order=[{key:"customer_name",label:"Name"},{key:"customer_email",label:"Email"},{key:"my_number",label:"Number"},{key:"plan_type",label:"Plan Type"},{key:"expiry_date",label:"Expiry Date"}];for(const item of order){let label=item.label,value=result[item.key];"my_number"===item.key&&value?value=`+${value}`:"expiry_date"===item.key&&value&&(value=new Date(value).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})),value&&(bodyHtml+=`\n                    <div class="pro_rows">\n                        <p class="pro_col pro_col_end"><span>${label}</span> <span>:</span></p>\n                        <span class="pro_col">${value}</span>\n                    </div>`)}resolve(bodyHtml)})});bodyHtml+=`<div class="premium_feature_block" id="buy_premium_block" style="border:none;display:flex;justify-content:center;align-items:center;gap:10px;flex-wrap:wrap;" dir="ltr">${await showBuyPremiumButtons()}</div>`,bodySection.innerHTML=bodyHtml,"es"===currentLanguage&&(mainDiv.style.top="35%"),mainDiv.append(topSection),mainDiv.append(bodySection),parentDiv.appendChild(mainDiv),document.getElementById("close_pro_profile_popup").addEventListener("click",()=>{parentDiv.removeChild(mainDiv)})}async function show_blur_dropdown(){try{const existingDropdown=document.querySelector("#blur_dropdown");if(existingDropdown)return void existingDropdown.remove();const mainDiv=document.createElement("div");mainDiv.id="blur_dropdown",mainDiv.classList.add("pro_profile_popup","blur_main"),mainDiv.dir="ltr";const topSection=document.createElement("div");topSection.classList.add("pro_profile_top"),topSection.innerHTML=`\n        <div class="pro_profile_cross" id="close_blur_dropdown">\n            <svg stroke="currentColor" fill="currentColor" stroke-width="0" \n                viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg">\n                <path d="M405 136.798L375.202 107 256 226.202 136.798 107 \n                         107 136.798 226.202 256 107 375.202 136.798 405 \n                         256 285.798 375.202 405 405 375.202 285.798 256z"></path>\n            </svg>\n        </div>\n        <div style="gap:20px" class="pro_profile_logo">\n            <div class="pro_profile_img blur_img">\n                <img style="height:40px;width:40px" src="${pro_logo_new}" alt="">\n            </div>\n            <h1 style="font-size:25px;color:#ffffff;">Blur Settings</h1>\n        </div>`;const blurOptions=[{key:"blur_chat_name",label:"Chat Name"},{key:"blur_profile_pic",label:"Profile Picture"},{key:"blur_chat_messages",label:"Chat Messages"}],bodySection=document.createElement("div");bodySection.classList.add("pro_profile_body","blur_body");const storedValues=await chrome.storage.local.get(blurOptions.map(opt=>opt.key));let html="";for(const item of blurOptions){const checked=storedValues[item.key]?"checked":"";html+=`\n          <div class="pro_rows blur_rows">\n              <p class="pro_col pro_col_end blur_end">\n                  <input type="checkbox" class="blur_checkbox" id="${item.key}" ${checked}>\n              </p>\n              <span class="pro_col">${item.label}</span>\n          </div>`}html+='<button class="blur_btn" id="blur_btn">Blur</button>',bodySection.innerHTML=html,bodySection.querySelectorAll(".blur_checkbox").forEach(checkbox=>{checkbox.addEventListener("change",async()=>{await chrome.storage.local.set({[checkbox.id]:checkbox.checked}),await toggle_blur(!1)})}),mainDiv.append(topSection,bodySection);const blurContactsBtn=document.getElementById("blur_contacts");blurContactsBtn&&blurContactsBtn.parentElement?(blurContactsBtn.parentElement.style.position="relative",blurContactsBtn.parentElement.appendChild(mainDiv)):document.body.appendChild(mainDiv),document.getElementById("blur_btn").addEventListener("click",async e=>{e.stopPropagation(),await chrome.storage.local.set({isBlurred:!0}),await toggle_blur(!0),mainDiv.remove()}),document.getElementById("close_blur_dropdown").addEventListener("click",e=>{e.stopPropagation(),mainDiv.remove()})}catch(error){console.error("Error :: show_blur_dropdown :: ",error)}}async function toggle_blur(click_event){try{const blurContactsBtn=document.getElementById("blur_contacts");if(!blurContactsBtn)return void console.warn("Blur button not found");const{isBlurred}=await chrome.storage.local.get("isBlurred"),blurKeys=["blur_chat_name","blur_profile_pic","blur_chat_messages"],blurSettings=await chrome.storage.local.get(blurKeys),hasAnyBlurEnabled=Object.values(blurSettings).some(val=>!0===val),blurGroups={blur_chat_name:[getDocumentElement("conversation_header_name_div"),...getDocumentElement("left_side_contacts_name",!0)],blur_profile_pic:[...getDocumentElement("contact_profile_div",!0),...getDocumentElement("conversation_panel_profile",!0)],blur_chat_messages:[...getDocumentElement("conversation_message_div",!0),...getDocumentElement("left_side_contacts_message",!0),...getDocumentElement("conversation_non_message_div",!0)]},replyDiv=document.querySelector("#reply_div");replyDiv&&(isBlurred&&blurSettings.blur_chat_messages?applyOrRemoveBlur(replyDiv,"blur",!0):applyOrRemoveBlur(replyDiv,"blur",!1));for(const[key,elements]of Object.entries(blurGroups))elements.forEach(el=>{blurSettings[key]&&isBlurred?applyOrRemoveBlur(el,"blur",!0):applyOrRemoveBlur(el,"blur",!1)});if(click_event){isBlurred&&hasAnyBlurEnabled?blurContactsBtn.classList.add("blurred"):blurContactsBtn.classList.remove("blurred");const iconSrc=isBlurred&&hasAnyBlurEnabled?pro_eye_visible:pro_eye_hidden;blurContactsBtn.innerHTML=`<img class='blur_icon' src=${iconSrc} alt='blur-info'>`,isBlurred&&hasAnyBlurEnabled&&trackButtonClick("blur_contacts")}}catch(e){console.error("Error :: toggle_blur :: ",e)}}function applyOrRemoveBlur(element,className,shouldApply){try{if(!element)return;shouldApply?element.classList.add(className):element.classList.remove(className)}catch(error){console.log(error)}}function suggestion_messages(){var reply_div=document.getElementById("reply_div");reply_div&&reply_div.parentNode.removeChild(reply_div);var smart_reply_edit_button=document.getElementById("smart_reply_edit_button");smart_reply_edit_button&&smart_reply_edit_button.parentNode.removeChild(smart_reply_edit_button);var footer=getDocumentElement("footer_div");if(!footer)return;footer.style.paddingTop="36px",(reply_div=document.createElement("div")).id="reply_div",reply_div.style.position="absolute",reply_div.style.top="0",reply_div.style.zIndex="1",reply_div.style.width="100%",reply_div.style.display="flex",reply_div.style.alignItems="center",reply_div.style.padding="8px 12px",reply_div.style.justifyContent="space-between",reply_div.style.boxSizing="border-box";var messagesContainer=document.createElement("div");messagesContainer.id="quick_reply_messages_container",messagesContainer.style.display="flex",messagesContainer.style.flexWrap="nowrap",messagesContainer.style.overflowX="auto",messagesContainer.style.overflowY="hidden",messagesContainer.style.alignItems="center",messagesContainer.style.flex="1",messagesContainer.style.gap="8px",messagesContainer.style.paddingRight="8px",messagesContainer.style.scrollBehavior="smooth",messagesContainer.style.minWidth="0",$.each(messages,function(i,p){let messageText="",messageValue="",hasAttachment=!1,messageBgColor="var(--outgoing-background)";"object"==typeof p?(messageBgColor=p.color||"var(--outgoing-background)",p.blob?(messageText=p.title||p.caption||p.name||"Attachment",messageValue=p.title||p.caption||"",hasAttachment=!0):(messageText=p.text||"",messageValue=p.text||"")):(messageText=p,messageValue=p);let displayText=messageText;messageText.length>47&&(displayText=messageText.substring(0,47)+"...");let buttonHTML='<button class="reply_click CtaBtn" style="color: var(--message-primary);background-color: '+messageBgColor+';border-radius: 15px;padding: 4px 8px;font-size: 12px;flex-shrink: 0;white-space: nowrap;direction: ltr !important;display: flex;align-items: center;gap: 4px;" value="'+messageValue+'">';hasAttachment&&(buttonHTML+='<img src="'+pro_attach_icon+'" style="width: 12px; height: 12px;" title="Has Attachment"/>'),buttonHTML+=displayText+"</button>";var dom_node=$($.parseHTML(buttonHTML));messagesContainer.appendChild(dom_node[0])}),total_messages=messages.length,reply_div.appendChild(messagesContainer);var buttonsContainer=document.createElement("div");buttonsContainer.style.display="flex",buttonsContainer.style.alignItems="center",buttonsContainer.style.gap="2px",buttonsContainer.style.flexShrink="0";var expandBtn=document.createElement("button");expandBtn.id="expand_quick_reply_btn",expandBtn.className="CtaBtn menu_btn",expandBtn.setAttribute("isExpand","false"),expandBtn.style.display="none",expandBtn.style.minWidth="32px",expandBtn.style.padding="4px 8px",expandBtn.style.flexShrink="0",expandBtn.style.cursor="pointer",expandBtn.style.background="none",expandBtn.style.border="none",expandBtn.style.transition="transform 0.3s ease, background-color 0.2s ease",expandBtn.style.borderRadius="6px";var expandImg=document.createElement("img");expandImg.src=pro_down_arrow,expandImg.style.width="20px",expandImg.style.height="20px",expandImg.style.display="block",expandImg.style.rotate="180deg",expandBtn.appendChild(expandImg),expandBtn.addEventListener("mouseenter",function(){expandBtn.style.backgroundColor="rgba(0, 0, 0, 0.1)"}),expandBtn.addEventListener("mouseleave",function(){expandBtn.style.backgroundColor="transparent"}),buttonsContainer.appendChild(expandBtn);var editBtn=document.createElement("button");editBtn.id="smart_reply_edit_button",editBtn.className="CtaBtn",editBtn.style.fontWeight="bold",editBtn.style.color="var(--message-primary)",editBtn.style.fontSize="12px",editBtn.style.flexShrink="0",editBtn.style.padding="4px 12px",editBtn.style.cursor="pointer",editBtn.style.background="none",editBtn.style.border="none",editBtn.style.transition="background-color 0.2s ease",editBtn.style.borderRadius="6px",editBtn.textContent="Edit",editBtn.addEventListener("mouseenter",function(){editBtn.style.backgroundColor="rgba(0, 0, 0, 0.1)"}),editBtn.addEventListener("mouseleave",function(){editBtn.style.backgroundColor="transparent"}),buttonsContainer.appendChild(editBtn),reply_div.appendChild(buttonsContainer),footer.appendChild(reply_div);let conversation_panel=getDocumentElement("conversation_panel");conversation_panel&&conversation_panel.scrollBy(0,33);var scrollWindow=document.getElementsByClassName("_33LGR")[0];function handleOverflowing(){setTimeout(()=>{isOverflowing(messagesContainer)?expandBtn.style.display="block":expandBtn.style.display="none"},20)}scrollWindow&&(scrollWindow.scrollTop=scrollWindow.scrollHeight),messagesContainer.addEventListener("click",async function(event){if(event.target.classList.contains("reply_click")){if(isPremiumFeatureAvailable()){var message=event.target.value;null!=message&&sendSuggestionMessage(message),trackButtonClick("smart_reply_sent_premium")}else premium_reminder("smart_reply","Premium");trackButtonClick("smart_reply_sent")}}),editBtn.addEventListener("click",function(event){suggestion_popup(),isPremiumFeatureAvailable()&&trackButtonClick("smart_reply_edit_premium"),trackButtonClick("smart_reply_edit")}),expandBtn.addEventListener("click",function(e){e.stopPropagation();let isExpand="true"===expandBtn.getAttribute("isExpand");isExpand?(messagesContainer.style.flexWrap="nowrap",footer.style.paddingTop="36px",expandImg.style.transform="rotate(0deg)"):(messagesContainer.style.flexWrap="wrap",footer.style.paddingTop=reply_div.offsetHeight+"px",expandImg.style.transform="rotate(180deg)",trackButtonClick("smart_reply_div_expanded")),expandBtn.setAttribute("isExpand",(!isExpand).toString())}),handleOverflowing(),window.addEventListener("resize",()=>{handleOverflowing()});let quickReplyButton=document.getElementsByClassName("reply_click")[0];quickReplyButton&&quickReplyButton.addEventListener("click",function(){chrome.storage.local.get(["premiumUsageObject"],function(result){if(void 0!==result.premiumUsageObject){let updatedPremiumUsageObject={...result.premiumUsageObject,quickReplies:!0};chrome.storage.local.set({premiumUsageObject:updatedPremiumUsageObject})}})})}async function send_quick_reply_message(message){if(!message||0==message.trim().length)return;if(!getDocumentElement("input_message_div"))return void trackError("input_div_not_found_quick_reply");trackButtonClick("smart_reply_sent");let result=messages.find(msg=>"object"==typeof msg&&msg.title===message);if(isPremiumFeatureAvailable())if(trackButtonClick("smart_reply_sent_premium"),result){if(!getDocumentElement("conversation_header"))return;let conv_msg_div=getDocumentElement("conversation_message_div"),curr_chat_id=conv_msg_div.dataset.id;if(trackSystemEvent("smart_reply_sent_attachment"),conv_msg_div&&conv_msg_div.dataset.id.includes("@g.us")){let group_id=curr_chat_id.split("_")[1];window.dispatchEvent(new CustomEvent("PROS::send-attachments-to-group",{detail:{groupId:group_id,attachments:[{data:result.blob,name:result.name}],caption:[result.caption||""],waitTillSend:!0,quick:!0}}))}else{let number_id=curr_chat_id.split("_")[1];window.dispatchEvent(new CustomEvent("PROS::send-attachments",{detail:{number:number_id,attachments:[{data:result.blob,name:result.name}],caption:[result.caption||""],waitTillSend:!0,quick:!0}}))}}else trackSystemEvent("smart_reply_sent_message"),pasteMessage(message),await sendMessageToNumber();else premium_reminder("smart_reply","Premium")}async function sendSuggestionMessage(message){return send_quick_reply_message(message)}function pasteMessage(text){const dataTransfer=new DataTransfer;dataTransfer.setData("text",text);const event=new ClipboardEvent("paste",{clipboardData:dataTransfer,bubbles:!0});getDocumentElement("input_message_div").dispatchEvent(event)}function isOverflowing(element){return element.scrollHeight>element.clientHeight||element.scrollWidth>element.clientWidth}function refresh_quick_replies(){let messages_list=document.getElementById("quick_reply_messages_list");messages_list&&(messages_list.innerHTML=messages.map((message,index)=>{let message_bg_color=message.color||(document.body.classList.contains("dark")?"#005c4b":"#d9fdd3"),messageText="";messageText="object"==typeof message?message.blob?message.title||message.caption||message.name||"Attachment":message.text||"":message;let hasAttachment="object"==typeof message&&message.blob;return`\n                <div class="message_row" draggable="true" index="${index}">\n                    <img class="drag_handle" src="${pro_drag_icon}" title="Reorder" style="width: 16px; height: 16px; flex-shrink: 0;"/>\n                    ${hasAttachment?`<img src="${pro_attach_icon}" title="Has Attachment" style="width: 14px; height: 14px; flex-shrink: 0;"/>`:""}\n                    <div class="message_div" title="Send" style="background-color: ${message_bg_color};">${messageText}</div>\n                    <input type="color" class="color-picker" index=${index} id="color${index}" value="${message_bg_color}" title="Change Background" style="flex-shrink: 0;"/>\n                    <img class="edit_message_btn" index="${index}" src="${pro_edit_icon}" title="Edit" style="width: 14px; height: 14px; cursor: pointer; flex-shrink: 0;"/>\n                    <img class="delete_message_btn" index="${index}" src="${pro_delete_icon}" title="Delete" style="width: 14px; height: 14px; cursor: pointer; flex-shrink: 0;"/>\n                </div>\n            `}).join("")),chrome.storage.local.set({messages}),chrome.storage.local.set({totalConvertedSize}),reload_quick_reply_div=!0,suggestion_messages();let dragged_index=null;document.querySelectorAll(".message_row").forEach(row=>{row.addEventListener("dragstart",e=>{let target_element=e.target,target_row=target_element.closest(".message_row");target_element.classList.contains("drag_handle")?(dragged_index=parseInt(target_row.getAttribute("index")),target_row.style.opacity="0.5"):e.preventDefault()}),row.addEventListener("dragover",e=>{e.preventDefault(),e.target.closest(".message_row").classList.add("dragged")}),row.addEventListener("dragleave",e=>{e.target.closest(".message_row").classList.remove("dragged")}),row.addEventListener("drop",e=>{e.preventDefault();let target_row=e.target.closest(".message_row"),dropped_index=parseInt(target_row.getAttribute("index"));if(dragged_index!==dropped_index){let moved_item=messages.splice(dragged_index,1)[0];messages.splice(dropped_index,0,moved_item),refresh_quick_replies(),trackButtonClick("smart_reply_reordered")}}),row.addEventListener("dragend",e=>{e.target.closest(".message_row").classList.remove("dragged"),e.target.closest(".message_row").style.opacity="1"})})}function referesh_messages(){refresh_quick_replies()}async function suggestion_popup(){let existingPopup=document.getElementById("edit_quick_reply_popup");if(existingPopup)try{document.body.removeChild(existingPopup)}catch(e){console.log("Could not remove existing popup")}let existingBackdrop=document.getElementById("quick_reply_backdrop");if(existingBackdrop)try{document.body.removeChild(existingBackdrop)}catch(e){console.log("Could not remove existing backdrop")}const backdrop=document.createElement("div");backdrop.id="quick_reply_backdrop",document.body.appendChild(backdrop);const edit_popup=document.createElement("div");edit_popup.id="edit_quick_reply_popup",edit_popup.className="edit_quick_reply_popup",edit_popup.innerHTML=`\n    <span id="close_edit_quick_reply_popup">\n      <img src="${pro_close_img_src}" alt="x"/>\n    </span>\n\n    <div class="reply_big_title">Edit / Add Quick Replies</div>\n    <div id="quick_reply_messages_list" class="messages_list"></div>\n    \n    <div class="input_container">\n      <div id="inputs_container">\n        <input type="text" id="title_input" placeholder="Name tag your quick reply here" class="title_input_container" />\n        <div style="position: relative;">\n          <textarea id="add_quick_reply_textarea" placeholder="Type your quick reply here"></textarea>\n          <img src="${pro_attach_icon}" alt="Add Attachment" id="add_quick_img_btn" class="attachment_icon tool-icon" title="Add Image Attachment"/>\n        </div>\n      </div>\n      <div id="add_quick_reply_btn_container" class="btn_container">\n        <button id="add_quick_reply_btn" class="text_btn">Add Template</button>\n        <input type="file" id="select-image" hidden />\n      </div>\n      <div id="edit_quick_reply_btn_container" class="btn_container">\n        <button id="save_quick_reply_btn" class="text_btn">Save</button>\n        <button id="cancel_quick_reply_btn" class="text_btn">Cancel</button>\n      </div>\n      <div id="add_quick_img_btn_container" class="btn_container">\n        <button id="save_quick_img_btn" class="text_btn">Save</button>\n        <button id="cancel_quick_img_btn" class="text_btn">Cancel</button>\n      </div>\n    </div>\n  `,backdrop.appendChild(edit_popup),refresh_quick_replies();const inputImage=document.getElementById("select-image");document.getElementById("close_edit_quick_reply_popup").addEventListener("click",()=>{try{document.body.removeChild(backdrop)}catch(e){console.log("Could not remove backdrop")}}),backdrop.addEventListener("click",e=>{if(e.target===backdrop)try{document.body.removeChild(backdrop)}catch(e){console.log("Could not remove backdrop")}}),document.getElementById("quick_reply_messages_list").addEventListener("click",event=>{event.stopPropagation();let targetElement=event.target,targetClass=event.target.classList,targetIndex=parseInt(event.target.getAttribute("index"));if(targetClass.contains("delete_message_btn")){const[deletedItem]=messages.splice(targetIndex,1);if(deletedItem&&deletedItem.blob){const byteSize=Math.ceil(3*deletedItem.blob.length/4);totalConvertedSize-=byteSize}refresh_quick_replies(),trackButtonClick("smart_reply_deleted")}else if(targetClass.contains("edit_message_btn")){if(!isNaN(targetIndex)){refresh_quick_replies(),document.querySelectorAll(".message_row")[targetIndex].classList.add("disabled");const msg=messages[targetIndex];document.getElementById("add_quick_reply_btn_container").style.display="flex",document.getElementById("edit_quick_reply_btn_container").style.display="none",document.getElementById("add_quick_img_btn_container").style.display="none","object"==typeof msg&&"image"===msg.type&&msg.blob?(toggleUI(!0),displayImageName(msg.name,""),document.getElementById("title_input").value=msg.title||"",document.getElementById("add_quick_reply_textarea").value=msg.caption||"",document.getElementById("add_quick_img_btn_container").setAttribute("index",targetIndex),document.getElementById("add_quick_img_btn_container").style.display="flex"):(toggleUI(!1),document.getElementById("add_quick_reply_textarea").value=("object"==typeof msg?msg.text:msg)||"",document.getElementById("add_quick_reply_btn_container").style.display="none",document.getElementById("edit_quick_reply_btn_container").style.display="flex",document.getElementById("edit_quick_reply_btn_container").setAttribute("index",targetIndex))}}else if(targetClass.contains("message_div")){try{document.body.removeChild(backdrop)}catch(e){console.log("Could not remove backdrop")}const msgIndex=parseInt(targetElement.closest(".message_row").getAttribute("index")),msg=messages[msgIndex];let contentToSend="";contentToSend="object"==typeof msg?msg.title||("image"===msg.type?msg.caption||msg.title||"":msg.text||""):msg,isPremiumFeatureAvailable()?(send_quick_reply_message(contentToSend),trackButtonClick("smart_reply_sent_premium")):premium_reminder("smart_reply","Premium"),trackButtonClick("smart_reply_sent")}else targetClass.contains("color-picker")&&targetElement.addEventListener("change",e=>{let newColor=e.target.value;"object"==typeof messages[targetIndex]?messages[targetIndex].color=newColor:messages[targetIndex]={type:"text",text:messages[targetIndex],caption:"",title:"",blob:null,name:null,color:newColor},refresh_quick_replies()},{once:!0})}),document.getElementById("add_quick_reply_btn").addEventListener("click",event=>{event.stopPropagation();let new_message=document.getElementById("add_quick_reply_textarea").value;if(new_message=filter_quick_reply_message(new_message),new_message){const messageObj={type:"text",text:new_message,caption:"",title:"",blob:null,name:null,color:document.body.classList.contains("dark")?"#005c4b":"#d9fdd3"};messages.push(messageObj),refresh_quick_replies(),document.getElementById("add_quick_reply_textarea").value="",trackButtonClick("smart_reply_added")}}),document.getElementById("add_quick_img_btn").addEventListener("click",event=>{event.stopPropagation(),inputImage.click(),inputImage.addEventListener("change",handleImageSelection,{once:!0})}),document.getElementById("save_quick_img_btn").addEventListener("click",()=>{const inputContent=document.getElementById("title_input"),captionContent=document.getElementById("add_quick_reply_textarea");let target_index=document.getElementById("add_quick_img_btn_container").getAttribute("index");inputContent.value.trim()?(target_index?(messages[target_index].type="image",messages[target_index].title=filter_quick_reply_message(inputContent.value),messages[target_index].caption=filter_quick_reply_message(captionContent.value),document.getElementById("add_quick_img_btn_container").setAttribute("index","")):window.currentImageData&&(window.currentImageData.type="image",window.currentImageData.title=filter_quick_reply_message(inputContent.value),window.currentImageData.caption=filter_quick_reply_message(captionContent.value),messages.push(window.currentImageData),window.currentImageData=null),refresh_quick_replies(),resetUI()):inputContent.focus()}),document.getElementById("cancel_quick_img_btn").addEventListener("click",()=>{resetUI(),inputImage.value="";let target_index=document.getElementById("add_quick_img_btn_container").getAttribute("index");target_index&&(document.querySelectorAll(".message_row")[target_index].classList.remove("disabled"),document.getElementById("add_quick_img_btn_container").setAttribute("index",""))}),document.getElementById("save_quick_reply_btn").addEventListener("click",event=>{event.stopPropagation();let new_message=document.getElementById("add_quick_reply_textarea").value.trim(),target_index=document.getElementById("edit_quick_reply_btn_container").getAttribute("index");new_message=filter_quick_reply_message(new_message),new_message&&target_index&&("object"==typeof messages[target_index]?(messages[target_index].text=new_message,messages[target_index].type="text"):messages[target_index]={type:"text",text:new_message,caption:"",title:"",blob:null,name:null,color:document.body.classList.contains("dark")?"#005c4b":"#d9fdd3"},refresh_quick_replies(),document.getElementById("add_quick_reply_textarea").value="",document.getElementById("add_quick_reply_btn_container").style.display="flex",document.getElementById("edit_quick_reply_btn_container").style.display="none",document.getElementById("edit_quick_reply_btn_container").setAttribute("index",""),trackButtonClick("smart_reply_edited"))}),document.getElementById("cancel_quick_reply_btn").addEventListener("click",event=>{event.stopPropagation(),refresh_quick_replies(),document.getElementById("add_quick_reply_textarea").value="",document.getElementById("add_quick_reply_btn_container").style.display="flex",document.getElementById("edit_quick_reply_btn_container").style.display="none",document.getElementById("edit_quick_reply_btn_container").setAttribute("index","")}),trackButtonClick("edit_smart_reply_popup")}function getFileDetails(file){return new Promise((resolve,reject)=>{if(!file)return void reject(new Error("No file provided"));if(file.size>10485760)return void resolve("More than 10MB file size is not allowed!");const fr=new FileReader;fr.readAsDataURL(file),fr.onload=()=>{const base64String=fr.result;(totalConvertedSize+=base64String.length)>52428800?resolve("Upload limit reached. You can only upload up to 50MB in total."):resolve({name:file.name,blob:JSON.stringify(base64String)})},fr.onerror=err=>reject(err)})}function toggleUI(showImageOptions){const addImgBtnContainer=document.getElementById("add_quick_img_btn_container"),addReplyBtnContainer=document.getElementById("add_quick_reply_btn_container"),titleInput=document.getElementById("title_input"),attachmentBtn=document.getElementById("add_quick_img_btn"),captionField=document.getElementById("add_quick_reply_textarea");addImgBtnContainer&&(addImgBtnContainer.style.display=showImageOptions?"flex":"none"),addReplyBtnContainer&&(addReplyBtnContainer.style.display=showImageOptions?"none":"flex"),titleInput&&(titleInput.style.display=showImageOptions?"block":"none"),attachmentBtn&&(attachmentBtn.style.display=showImageOptions?"none":"block"),captionField&&(captionField.placeholder=showImageOptions?"Type your caption here":"Type your quick reply here",captionField.classList.toggle("title_textarea",showImageOptions))}function displayImageName(imageName,classRed){let existingPTag=document.getElementById("image_name");if(!existingPTag){existingPTag=document.createElement("p"),existingPTag.className=`image_name ${classRed}`,existingPTag.id="image_name";const inputsContainer=document.getElementById("inputs_container");inputsContainer&&inputsContainer.append(existingPTag)}existingPTag.setAttribute("title",imageName),existingPTag.innerText=imageName}function resetUI(){toggleUI(!1);const imageNameEl=document.getElementById("image_name");imageNameEl&&imageNameEl.remove();const titleInput=document.getElementById("title_input"),textarea=document.getElementById("add_quick_reply_textarea");titleInput&&(titleInput.value=""),textarea&&(textarea.value="")}async function handleImageSelection(event){const file=event.target.files[0];if(file){toggleUI(!0);try{const fileData=await getFileDetails(file);"string"!=typeof fileData?(window.currentImageData={type:"image",text:"",caption:"",title:"",blob:fileData.blob,name:fileData.name,color:document.body.classList.contains("dark")?"#005c4b":"#d9fdd3"},displayImageName(fileData.name,"")):(resetUI(),displayImageName(fileData,"error_class"),setTimeout(()=>{resetUI()},2e3))}catch(error){resetUI(),console.error(error.message)}}}function filter_quick_reply_message(message){return message.replace(/&nbsp;/g," ").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#39;/g,"'").trim()}async function reload_my_number(){if(!my_number)try{var last_wid=window.localStorage.getItem("last-wid");window.localStorage.getItem("last-wid-md")?my_number=window.localStorage.getItem("last-wid-md").split("@")[0].substring(1).split(":")[0]:last_wid&&(my_number=window.localStorage.getItem("last-wid").split("@")[0].substring(1)),my_number&&chrome.storage.local.set({my_number})}catch(e){trackError("my_number_error",e),console.log(e)}if(!my_number){let result=await chrome.storage.local.get("my_number");my_number=result.my_number||null}if(my_number)fetch_plan_details(),trackSystemEvent("my_number",my_number);else{trackSystemEvent("no_number","track");try{trackSystemEvent("no_number_local_storage",window.localStorage)}catch(e){console.log(e)}}}function setGroupDataToLocalStorage(data){let finalGroupData=data.map(group=>({...group,objId:"g"+group.id._serialized.replace(/\D+/g,"")}));chrome.storage.local.set({allGroupData:finalGroupData});data.forEach(group=>{const groupid=group.id._serialized;groupid&&group.name&&(groupIdToName[groupid]=group.name)})}function setContactDataToLocalStorage(data){let finalContactData=data.map(contact=>({...contact,objId:"c"+contact.id._serialized.replace(/\D+/g,"")}));chrome.storage.local.set({allContactData:finalContactData});data.forEach(contact=>{const contact_id=contact.id._serialized;contact_id&&contact.name&&(contactIdToName[contact_id]=contact.name)})}function setLabelDataToLocalStorage(data){chrome.storage.local.set({allLabelData:data})}async function readFileAndSaveToLocalStorage(e,localStorageName){let files=e.target.files,renderedFiles=[],fileReadPromises=Array.from(files).map(file=>new Promise(resolve=>{const reader=new FileReader;reader.onload=function(event){const base64Data=event.target.result,fileData={name:file.name,type:file.type,data:base64Data};renderedFiles.push(fileData),resolve()},reader.readAsDataURL(file)}));await Promise.all(fileReadPromises),chrome.storage.local.set({[localStorageName]:renderedFiles})}async function handleAddAttachment(){let inputElement=document.createElement("input");inputElement.type="file",inputElement.id="new_input_element",inputElement.multiple=!0,document.body.appendChild(inputElement),inputElement.click(),inputElement.addEventListener("change",async function(e){let fileCount=inputElement?.files.length;fileCount&&fileCount>1&&!isAdvanceFeatureAvailable()?premium_reminder("multiple_attachments","Advance"):await readFileAndSaveToLocalStorage(e,"linuxInputAttachments"),inputElement.remove()})}function handleAddCSVInput(){let inputElement=document.createElement("input");inputElement.type="file",inputElement.id="new_csv_input_element",inputElement.accept=".xls,.xlsx,.ods,.csv",document.body.appendChild(inputElement),inputElement.click(),inputElement.addEventListener("change",async function(e){await readFileAndSaveToLocalStorage(e,"linuxCSVAttachment"),inputElement.remove()})}function init(){messageListner(),window.onload=function(){"web.whatsapp.com"===window.location.host&&(reload_my_number(),chrome.storage.local.get(["messages","totalConvertedSize"],function(result){result.messages&&(messages=result.messages),result.totalConvertedSize&&(totalConvertedSize=result.totalConvertedSize)}),setInterval(()=>{document.getElementById("reply_div")&&messages.length===total_messages||suggestion_messages();document.getElementById("download_group_btn")||download_group_contacts();document.getElementById("translate_div")||translate_messages();document.getElementById("profile_header_buttons_div")||profile_header_buttons();const main_panel=document.getElementById("main"),sidePanel=document.querySelector("#pane-side");(sidePanel||main_panel)&&toggle_blur(null),sidePanel||detectBanText()},1e3),trackSystemEvent("whatsapp_visit",my_number));const profileHeaderInterval=setInterval(()=>{getDocumentElement("profile_header")&&(clearInterval(profileHeaderInterval),handleScheduleCampaigns())},100)}}function openEmailPopup(email_message){let mailtoLink="mailto:prosendertool@gmail.com?subject="+encodeURIComponent("Chat support for Pro Sender")+"&body="+encodeURIComponent(email_message);window.open(mailtoLink,"_blank")}function messageListner(){chrome.runtime.onMessage.addListener(listner)}function listner(request,sender,sendResponse){"number_message"===request.type?messenger(request.numbers,request.message,request.time_gap,request.csv_data,request.customization,request.caption_customization,request.random_delay,request.batch_size,request.batch_gap,request.caption,request.send_attachment_first,request.type,request.startIndex,request.paused_report_rows,request.paused_sent_count,request.attachmentsData,request.custom_time_range):"group_message"===request.type?messenger(request.groups,request.message,request.time_gap,request.csv_data,request.customization,request.caption_customization,request.random_delay,request.batch_size,request.batch_gap,request.caption,request.send_attachment_first,request.type,request.startIndex,request.paused_report_rows,request.paused_sent_count,request.attachmentsData,request.custom_time_range):"show_message_count_over_popup"===request.type?messageCountOverPopup():"schedule_message"===request.type?handleScheduleCampaigns():"clear_schedule_timeout"===request.type?clearTimeout(request.timeoutId):"help"===request.type?handle_help():"transfer_premium"===request.type?help(request.message):"show_premium_popup"===request.type?premium_reminder(request.feature,"Premium"):"show_advance_popup"===request.type?premium_reminder(request.feature,"Advance"):"add_attachments"===request.type?handleAddAttachment():"create_csv_input"===request.type?handleAddCSVInput():"reload_contacts"===request.type?window.dispatchEvent(new CustomEvent("PROS::get-all-contacts")):"reload_my_number"===request.type?reload_my_number():"chat_link"===request.type?chat_link():"unsaved_contacts_demo"===request.type?unsavedContactsDemo():"request_chat_premium"===request.type?isAdvance()?help(HELP_MESSAGES.REQUEST_CHAT_SUPPORT_ADVANCE):help(HELP_MESSAGES.REQUEST_CHAT_SUPPORT_BASIC):"request_zoom_premium"===request.type?isAdvance()?help(HELP_MESSAGES.REQUEST_ZOOM_SUPPORT_ADVANCE):help(HELP_MESSAGES.REQUEST_ZOOM_SUPPORT_BASIC):"request_call_premium"===request.type?isAdvance()?help(HELP_MESSAGES.REQUEST_CALL_SUPPORT_ADVANCE):help(HELP_MESSAGES.REQUEST_CALL_SUPPORT_BASIC):"unsubscribe"===request.type?help(HELP_MESSAGES.UNSUBSCRIBE_PLAN):"learn_schedule"===request.type?help(HELP_MESSAGES.LEARN_SCHEDULE):"buy_premium_popup"===request.type&&show_trial_popups()}function sendChromeMessage(message){chrome.runtime.sendMessage(message)}function help(message){chrome.storage.local.get(["currentLanguage","customer_care_number"],async res=>{let help_message=message.replace(/ /gm," "),language=res.currentLanguage||"default";HELP_MESSAGE_LANGUAGE_CODES.includes(language)&&(help_message=await translate(help_message)),await openNumber(res.customer_care_number,help_message),await sendMessage()})}function handle_help(){isPremium()?isAdvance()?help(HELP_MESSAGES.REQUEST_CHAT_SUPPORT_ADVANCE):help(HELP_MESSAGES.REQUEST_CHAT_SUPPORT_BASIC):my_number&&my_number.startsWith(62)?openEmailPopup(HELP_MESSAGES.NEED_HELP_NON_PREMIUM):help(HELP_MESSAGES.NEED_HELP_NON_PREMIUM)}async function unsavedContactsDemo(){let translatedExportUnsavedContactsObj=await fetchTranslations(exportUnsavedContactsObj);driver(translatedExportUnsavedContactsObj).drive()}function getTodayDate(){let today=new Date,dd=String(today.getDate()).padStart(2,"0"),mm=String(today.getMonth()+1).padStart(2,"0");return today.getFullYear()+"-"+mm+"-"+dd}async function delay(ms){if(0!=ms)return new Promise(resolve=>{cancelDelay=resolve,setTimeout(resolve,ms)})}async function sendMessage(){return new Promise(resolve=>{setTimeout(()=>{let send_message_btn=getDocumentElement("send_message_btn");send_message_btn?(send_message_btn.click(),resolve(["Yes",""])):resolve(["No","Issue with the number"])},500)})}function download_report(){let s="data:text/csv;charset=utf-8,"+rows.map(e=>e.join(",")).join("\n");var o=encodeURI(s),l=document.createElement("a");l.setAttribute("href",o),l.setAttribute("download","report.csv"),document.body.appendChild(l),l.click()}function getTrackLabel(){try{return[my_number,plan_type,plan_duration].join(" ").trim()}catch{return""}}function getTrackLocation(){return location_info.default?{}:{city:location_info.city,region:location_info.region,country:location_info.country,dial_code:location_info.dial_code}}function getTrackContext(){return{init_store_type,whatsapp_version,extension_version}}function trackEvent(event,track){trackGenericEvent(event,{type:"event",track,natural_interaction:!0})}function trackButtonClick(event){trackGenericEvent(event,{type:"clicked",natural_interaction:!0})}function trackCloseButtonClick(event){trackGenericEvent(event,{type:"clicked"})}function trackButtonView(event){trackGenericEvent(event,{type:"viewed"})}function trackSystemEvent(event,track=""){trackGenericEvent(event,{type:"event",track})}function trackSuccess(event){trackGenericEvent(event,{type:"success"})}function trackError(event,error=""){trackGenericEvent(event,{type:"error",error:String(error)})}function trackGenericEvent(event,data){let label=getTrackLabel(),combinedData={...getTrackLocation(),...getTrackContext(),...data},eventData=Object.fromEntries(Object.entries(combinedData).filter(([key,value])=>null!=value||null!=value));GoogleAnalytics.trackEvent(event,{label,...eventData})}function convertDate(date=null){return date||(date=new Date),date.getFullYear()+"-"+(date.getMonth()+1)+"-"+date.getDate()}function dateDiff(date1,date2){if(date1&&date2)return Math.ceil((date2-date1)/864e5)}function check_web_and_show_trial_popups(){if(null!==document.getElementById("side")){if(show_trial_popups(),!my_number)return}else setTimeout(check_web_and_show_trial_popups,500)}function show_trial_popups(){chrome.storage.local.get(["is_advance_promo_activated","content_visits","plan_type","created_date","expiry_date","last_plan_type","subscribed_date","location_info"],function(result){plan_type=result.plan_type||"Advance",last_plan_type=result.last_plan_type||"Expired",location_info=result.location_info||location_info;let today=new Date,content_visits=result.content_visits||0,expiry_date=result.expiry_date?new Date(result.expiry_date):null,subscribed_date=(result.created_date&&new Date(result.created_date),result.subscribed_date?new Date(result.subscribed_date):null),is_advance_promo_activated=result.is_advance_promo_activated||"NO",date_diff=expiry_date?dateDiff(today,expiry_date):7;if(subscribed_date&&expiry_date){let plan_days=Math.abs(dateDiff(expiry_date,subscribed_date));plan_duration=plan_days>31?"Yearly":"Monthly"}"FreeTrial"===plan_type?0===content_visits?display_popup("free_trial_start",date_diff):date_diff<=7&&display_popup("free_trial_reminder",date_diff):"AdvancePromo"===plan_type?"NO"===is_advance_promo_activated?(is_advance_promo_activated="YES",display_popup("advance_promo_start",date_diff)):date_diff<=5&&display_popup("advance_promo_reminder",date_diff):"Expired"===plan_type&&date_diff<=0&&my_number&&null!=my_number?"Basic"===last_plan_type||"Advance"===last_plan_type?display_popup("premium_expired",date_diff):"FreeTrial"===last_plan_type?display_popup("free_trial_expired"):"AdvancePromo"===last_plan_type&&display_popup("advance_promo_expired"):("Basic"==plan_type||"Advance"==plan_type)&&"Monthly"==plan_duration&&date_diff<=5&&callIfNoOtherPopups(()=>buyAnnualPopup()),chrome.storage.local.set({content_visits:content_visits+1,plan_duration,is_advance_promo_activated}),chrome.runtime.sendMessage({},function(response){trackSystemEvent("logged_mail","logged_in_user")})})}function isExpired(){return"Expired"===plan_type}function isBasic(){return"Basic"===plan_type}function isAdvance(){return"Advance"===plan_type}function isPremium(){return"Basic"===plan_type||"Advance"===plan_type}function isFreeTrial(){return"FreeTrial"===plan_type}function isAdvancePromo(){return"AdvancePromo"===plan_type}function isTrial(){return"FreeTrial"===plan_type||"AdvancePromo"===plan_type}function isBasicFeatureAvailable(){return isBasic()||isTrial()}function isAdvanceFeatureAvailable(){return isAdvance()||isAdvancePromo()}function isPremiumFeatureAvailable(){return!0}function fetch_plan_details(){handle_response(res)}async function fetch_data(number){return new Promise(function(resolve,reject){$.ajax({type:"GET",url,success:function(response){resolve(response.body)},error:function(error){reject(error)},dataType:"json",contentType:"application/json"})})}function handle_response(data){(data={plan_type:"Advance",created_date:"11/11/2025",expiry_date:"11/11/2099",last_plan_type:"Advance",subscribed_date:"11/11/2025",name:"fake",email:"fake@fake.com",customer_care_number:"111111111"})?(data.plan_type&&(plan_type=data.plan_type,chrome.storage.local.set({plan_type:data.plan_type})),data.created_date&&chrome.storage.local.set({created_date:data.created_date}),data.expiry_date&&(expiry_date=data.expiry_date,chrome.storage.local.set({expiry_date:data.expiry_date})),data.last_plan_type&&(last_plan_type=data.last_plan_type,chrome.storage.local.set({last_plan_type:data.last_plan_type})),data.subscribed_date&&chrome.storage.local.set({subscribed_date:data.subscribed_date}),data.name?chrome.storage.local.set({customer_name:data.name}):chrome.storage.local.set({customer_name:null}),data.email?chrome.storage.local.set({customer_email:data.email}):chrome.storage.local.set({customer_email:null}),null!=data.customer_care_number&&null!=data.customer_care_number&&""!=data.customer_care_number?chrome.storage.local.set({customer_care_number:data.customer_care_number}):chrome.storage.local.set({customer_care_number:"918178004424"}),data.trial_days&&(chrome.storage.local.set({trial_days:data.trial_days}),chrome.storage.local.get(["atd860"],res=>{let atd860=res.atd860;void 0===atd860||atd860||(chrome.storage.local.remove("atd860"),chrome.runtime.sendMessage({type:"set_uninstall_url",trial_days:data.trial_days,number:my_number+data.plan_type}))})),check_web_and_show_trial_popups(),trackSystemEvent("plan_details_fetched","fetched")):(alert("Something went wrong in account. Please contact support at Whatsapp number +919178004424"),chrome.storage.local.clear())}async function convertPriceToLocale(price){const res=await fetch("https://cdn.jsdelivr.net/npm/@fawazahmed0/currency-api@latest/v1/currencies/usd.json"),jsonData=await res.json();let{currency}=location_info,formatter=new Intl.NumberFormat("en-US",{style:"currency",currency,maximumFractionDigits:0}),exchangeRate=jsonData.usd[currency.toLowerCase()];return formatter.format(Math.round(1.02*exchangeRate*parseFloat(price)))}function getFreeTrialButtonHtml(){return'<a href="" target="_blank" class="popup-btn pricing-green-btn CtaBtn" style="font-weight:bold;">\n            Buy Premium\n        </a>'}async function getBasicPremiumExpiredButton(basicPrice,basicConvertedPrice,advancePrice,advanceConvertedPrice,pricing_link){return{basicButtonHtml:await basicButton(pricing_link+"basic",basicPrice,basicConvertedPrice),advanceButtonHtml:await advanceButton(pricing_link+"advance",advancePrice,advanceConvertedPrice,"premium_expired")}}async function getAdvancePremiumExpiredButton(advancePrice,advanceConvertedPrice,pricing_link){return await advanceButton(pricing_link+"advance",advancePrice,advanceConvertedPrice,"premium_expired",!1)}function getAnnualButtonHtml(){let{name:country_name,name_code:country_code,currency:country_currency}=location_info;country_name=Object.keys(COUNTRY_WITH_SPECIFIC_PRICING).includes(country_code)?COUNTRY_WITH_SPECIFIC_PRICING[country_code]:"international";return'<a href="" target="_blank" class="popup-btn pricing-green-btn CtaBtn" style="font-weight:bold;">\n            Buy Annual \n        </a>'}async function create_pricing_buttons_html(popup_name){let pricing_data=PRICING_DATA[popup_name];if(!pricing_data)return"";let{name:country_name,name_code:country_code,currency:country_currency}=location_info;country_name=Object.keys(COUNTRY_WITH_SPECIFIC_PRICING).includes(country_code)?COUNTRY_WITH_SPECIFIC_PRICING[country_code]:"international";let advancePrice=pricing_data.advance_price[country_name],basicPrice=pricing_data.basic_price[country_name],advanceConvertedPrice=await convertPriceToLocale(advancePrice.substring(1)),basicConvertedPrice=await convertPriceToLocale(basicPrice.substring(1)),basicButtonHtml=(await multipleAccountButton(),await basicButton("basic",basicPrice,basicConvertedPrice)),advanceButtonHtml=await advanceButton("advance",advancePrice,advanceConvertedPrice,popup_name),showBasicButton=!0,showAdvanceButton=!1;"Advance"==last_plan_type&&(showBasicButton=!1,showAdvanceButton=!0);let popup_button_html="";if("free_trial_reminder"!=popup_name&&"free_trial_expired"!=popup_name||(popup_button_html=getFreeTrialButtonHtml(),showBasicButton=!1,showAdvanceButton=!1),"premium_expired"==popup_name&&"Basic"==last_plan_type){let buttons=await getBasicPremiumExpiredButton(basicPrice,basicConvertedPrice,advancePrice,advanceConvertedPrice,"");basicButtonHtml=buttons.basicButtonHtml,advanceButtonHtml=buttons.advanceButtonHtml,showBasicButton=!0,showAdvanceButton=!0}return"premium_expired"==popup_name&&"Advance"==last_plan_type&&(advanceButtonHtml=await getAdvancePremiumExpiredButton(advancePrice,advanceConvertedPrice,""),showBasicButton=!1,showAdvanceButton=!0),"buy_annual"==popup_name&&(popup_button_html=getAnnualButtonHtml(),showBasicButton=!1,showAdvanceButton=!1),`\n    <div style="display:flex;flex-direction:column;gap:6px;margin-bottom:20px;">\n        <div class="pricing-buttons-container" style="margin-bottom:0px;"> \n            ${showBasicButton?basicButtonHtml:""}\n            ${showAdvanceButton?advanceButtonHtml:""}\n            \n            ${popup_button_html}\n        </div>\n        <div style="width:100%;display:flex;justify-content:center;align-items:center;flex-direction:column;color:#fff;">\n            <span style="margin-bottom:5px">or</span>\n            <a href="" target="_blank" style="color:#009a88;font-size:14px;text-decoration:underline;text-underline-offset:2px;display:flex;justify-content:center;align-items:center;gap:3px;"><img src="${pro_multiple_users_icon}" style="width:18px;"/>Buy multiple users upto 70% discount</a>\n        </div>\n    </div>\n    `}function create_features_list_html(popup_name){let features_html="",show_advance_bracket=!0;return popup_name.includes("advance_promo")&&(show_advance_bracket=!1),$.each(PREMIUM_FEATURES,function(i,feature){features_html+=`\n            <div class="trial_feature" style="font-weight: bold;color: #fff;">\n                <span class="check_icon"></span>${feature}\n                ${show_advance_bracket?'<span style="color:#009a88;margin-left: 5px;"> (Advance) </span>':""}\n            </div>`}),$.each(TRIAL_FEATURES,function(i,feature){features_html+=`<div class="trial_feature" style="color: #fff;"><span class="check_icon"></span>${feature}</div>`}),features_html}function create_footer_html(){return`\n        <div class="popup-footer">\n            <div class="popup-footer-container">\n                <div class="logo-div">\n                    <img class="logo-icon" src="${window.logo_img}" alt="Logo"/>\n                    <img class="logo-text" src="${window.logo_text}" alt="Logo Text"/>\n                </div>\n                <div class="contact-div">\n                    <p>Any questions?</p>\n                    <a class="handle_help_btn CtaBtn">Contact Support</a>\n                </div>\n            </div>\n        </div>`}async function create_popup_html(popup_name,date_diff){const data=POPUP_DATA[popup_name],common=POPUP_DATA.common,title_text=data.title?data.title.replace("{VAR_DATE_DIFF}",`<br /><span class="expire_date_number">${date_diff}</span>`).replace("{VAR_EXP_TEXT}",date_diff>0?`expires in ${date_diff} days`:"have expired"):null,pricing_buttons_html=await create_pricing_buttons_html(popup_name),features_html=create_features_list_html(popup_name),footer_html=create_footer_html();return`\n        <div class="${popup_name}_content trial_content" style="background: ${data.background_color}">\n            ${data.close_button?`<span class="CtaCloseBtn popup-close-btn" id="close_${popup_name}_popup"><img src=${pro_close_img_src} /></span>`:""}\n\n            <div class="popup-header">\n                ${data.heading?`<div class="trial_big_title heading ${popup_name}_bold">${await translate(data.heading)}</div>`:""}\n                <div class="trial_big_title">\n                    ${data.icon?`<img src=${window[data.icon]} />`:""}\n                    ${title_text?`<p>${await translate(title_text)}</p>`:""}\n                </div>\n                ${data.description?`<div class="trial_title">${await translate(data.description)}</div>`:""}\n            </div>\n\n            <div class="trial_separator_line ${popup_name}_divider"></div>\n\n            <div class="popup-center"> \n                <div class="trial_features">${features_html}</div>\n                ${data.note?`<div class="trial_desc">${await translate(data.note)}</div>`:""}\n                ${pricing_buttons_html}\n                ${data.action_button?`<div id="${data.action_button.id}" class="popup-btn CtaBtn ${data.action_button.class}">${data.action_button.text}</div>`:""}\n                ${data.recommend_price?`<div class="popup-message popup-recommendation-message"><img src="${pro_recommend_tick}"> ${await translate(common.recommend_text)}</div>`:""}\n                ${data.discount_text?`<div class="popup-message popup-discount-message">*${await translate(common.discount_text)}</div>`:""}\n                ${data.purchase_note?`<div class="popup-message popup-purchase-note">${await translate(common.purchase_note)}</div>`:""}  \n            </div>\n\n            ${footer_html}\n        </div>\n    `}function show_loader_and_close_popup(popup_name,delay,next_popup=!1){$(`#close_${popup_name}_popup`).addClass("loading").html(""),setTimeout(()=>{$(`#${popup_name}_popup`).remove(),next_popup&&success_popup(next_popup)},delay)}async function display_popup(popup_name,date_diff){$(`#${popup_name}_popup`)&&$(`#${popup_name}_popup`).remove();const popup_html=await create_popup_html(popup_name,date_diff),new_popup=$("<div>").html(popup_html).attr({class:`${popup_name}_popup trial_popup`,id:`${popup_name}_popup`});$("body").append(new_popup),$(`#close_${popup_name}_popup`).on("click",function(event){"advance_promo_start"!==popup_name?($(`#${popup_name}_popup`).remove(),trackCloseButtonClick(`${popup_name}_popup_close`)):show_loader_and_close_popup(popup_name,1e3,"advance_promo_activated")}),$(".popup-btn").on("click",function(event){let buttonType=$(this).attr("buttonType");buttonType&&buttonType.length>0&&trackButtonClick(`${popup_name}_popup_${buttonType}_button`)}),trackButtonView(`${popup_name}_popup`)}async function success_popup(success_popup_name){$(`#${success_popup_name}_popup`)&&$(`#${success_popup_name}_popup`).remove();const data=SUCCESS_POPUP_DATA[success_popup_name],description=data.description.replace("Advance Premium","<strong>Advance Premium</strong>"),popup_html=`\n        <div class="${success_popup_name}_content success_content" style="background: ${data.background_color}">\n            ${data.close_button?`<span class="CtaCloseBtn popup-close-btn" id="close_${success_popup_name}_popup"><img src=${pro_close_img_src} /></span>`:""}\n            <div class="popup-header">\n                <img class="${data.icon}" src=${window[data.icon]} />\n            </div>\n            <div class="popup-center">\n                <p class="trial_big_title heading">${data.title}</p>\n                <p class="trial_title">${description}</p>\n                ${data.action_button?`<div id="${data.action_button.id}" class="popup-btn CtaBtn ${data.action_button.class}" buttonType="okay">${data.action_button.text}</div>`:""}\n            </div>\n        </div>\n    `,new_popup=$("<div>").html(popup_html).attr({class:`${success_popup_name}_popup success_popup`,id:`${success_popup_name}_popup`}).css("width","min(400px, 95%)");$("body").append(new_popup),$(`#close_${success_popup_name}_popup`).on("click",function(event){$(`#${success_popup_name}_popup`).remove(),trackCloseButtonClick(`${success_popup_name}_popup_close`)}),$(".popup-btn").on("click",function(event){let buttonType=$(this).attr("buttonType");buttonType&&buttonType.length>0&&trackButtonClick(`${success_popup_name}_popup_${buttonType}_button`)}),trackButtonView(`${success_popup_name}_popup`)}async function multipleAccountButton(){let{name:country_name,name_code:country_code,currency:country_currency}=location_info;return country_name=Object.keys(COUNTRY_WITH_SPECIFIC_PRICING).includes(country_code)?COUNTRY_WITH_SPECIFIC_PRICING[country_code]:"international",`<a href="" target="_blank" class="popup-btn pricing-purple-btn CtaBtn" buttonType="multiple_account">\n        <span style="white-space:nowrap;">Buy multiple users<br/></span>\n        <span style="white-space:nowrap; color: #fff; font-size: 14px; line-height: 16px;font-weight:bold;display:flex;"><span style="margin-right:3px;">@</span>\n            ${"india"===country_name?'<span class="rupee"></span>':""}\n            <span class="price_class">${MULT25ACCOUNTPRICE[country_name]}</span>/month\n        </span>\n        ${"international"===country_name&&"USD"!=country_currency?`<span style="white-space:nowrap; color: #fff; font-size: 12px; line-height: 16px;font-weight:bold;"> \n(~<span class="price_class">${await convertPriceToLocale(MULT25ACCOUNTPRICE[country_name].substring(1))}</span>/month)\n</span>`:""}\n    </a>`}async function basicButton(pricing_link="",basicPrice="",basicConvertedPrice=""){let{name:country_name,name_code:country_code,currency:country_currency}=location_info;country_name=Object.keys(COUNTRY_WITH_SPECIFIC_PRICING).includes(country_code)?COUNTRY_WITH_SPECIFIC_PRICING[country_code]:"international";let converted_price=basicConvertedPrice;return basicConvertedPrice&&""!=basicConvertedPrice||(converted_price=await convertPriceToLocale(basicPrice.substring(1))),`<a href="${pricing_link}" target="_blank" class="popup-btn pricing-white-btn CtaBtn" style="font-weight:bold;" buttonType="basic">\n        Buy Basic<br/>\n        <span style="white-space:nowrap; color: #009a88; font-size: 14px; line-height: 16px;font-weight:bold;display:flex;"><span style="margin-right:3px;">@</span> \n            ${"india"===country_name?'<span class="rupee"></span>':""}\n            <span class="price_class">${basicPrice}</span>/month\n        </span>\n        ${"international"===country_name&&"USD"!=country_currency?`<span style="white-space:nowrap; color: #009a88; font-size: 12px; line-height: 16px;font-weight:bold;">\n(~<span class="price_class">${converted_price}</span>/month)\n</span>`:""}\n    </a>`}async function advanceButton(pricing_link="",advancePrice="",advanceConvertedPrice="",popup_name,showPrice=!0){let{name:country_name,name_code:country_code,currency:country_currency}=location_info;country_name=Object.keys(COUNTRY_WITH_SPECIFIC_PRICING).includes(country_code)?COUNTRY_WITH_SPECIFIC_PRICING[country_code]:"international";let converted_price=advanceConvertedPrice;return advanceConvertedPrice&&""!=advanceConvertedPrice||(converted_price=await convertPriceToLocale(advancePrice.substring(1))),"free_trial_start"!=popup_name&&"free_trial_reminder"!=popup_name&&"free_trial_expired"!=popup_name&&"AdvancePromo"!=last_plan_type&&"advance_promo_activated"!=popup_name&&"advance_promo_reminder"!=popup_name&&"advance_promo_expired"!=popup_name||(pricing_link=""),`<a href="${pricing_link}" target="_blank" class="popup-btn pricing-green-btn CtaBtn" style="font-weight:bold;" buttonType="advance">\n        Buy Advance\n        ${showPrice?`<br/>\n            <span style="white-space:nowrap; font-size: 14px; line-height: 16px;font-weight:bold;display:flex;"><span style="margin-right:3px;">@</span>\n                ${"india"===country_name?'<span class="rupee"></span>':""}\n                <span class="price_class">${advancePrice}</span>/month\n            </span>\n            ${"international"===country_name&&"USD"!=country_currency?`<span style="white-space:nowrap; font-size: 12px; line-height: 16px;font-weight:bold;"> \n    (~<span class="price_class">${converted_price}</span>/month)\n    </span>`:""}`:""}\n    </a>`}function getPremiumReminderButton(req_plan_type){let{name:country_name,name_code:country_code,currency:country_currency}=location_info;country_name=Object.keys(COUNTRY_WITH_SPECIFIC_PRICING).includes(country_code)?COUNTRY_WITH_SPECIFIC_PRICING[country_code]:"international";let pricing_link="";return"FreeTrial"==last_plan_type&&"Basic"==req_plan_type?pricing_link="":pricing_link+="Advance"==req_plan_type?"advance":"basic",`<a href="${pricing_link}" target="_blank" class="popup-btn pricing-white-btn CtaBtn" buttonType="${req_plan_type.toLowerCase()}">\n            Buy ${req_plan_type}\n        </a>`}async function premium_reminder(feature,req_plan_type){let{name:country_name,name_code:country_code,currency:country_currency}=location_info;country_name=Object.keys(COUNTRY_WITH_SPECIFIC_PRICING).includes(country_code)?COUNTRY_WITH_SPECIFIC_PRICING[country_code]:"international",feature||(feature="default");let body=document.querySelector("body"),popup=document.createElement("div"),modal_content=document.createElement("div"),popup_button=getPremiumReminderButton(req_plan_type);document.querySelector(".premium_reminder_popup")&&body.removeChild(document.querySelector(".premium_reminder_popup")),popup.className="premium_reminder_popup trial_popup",modal_content.className="premium_reminder_content trial_content",modal_content.innerHTML=`\n        <span id="close_premium_reminder_popup">\n            <img class="CtaCloseBtn" src="${pro_close_img_src}" alt="x">\n        </span>\n        <div class="premium_reminder_popup_title">\n            <span class="oops_icon"></span>Oops!\n        </div>\n        <div class="reminder_title">\n            ${await translate(PREMIUM_REMINDER[feature].title)}\n        </div>\n        <div class="reminder_description">\n            ${await translate(`Please buy <<${req_plan_type} Plan>> ${PREMIUM_REMINDER[feature].description}`)}\n        </div>\n        <div style="display:flex;justify-content:center;gap:20px;width:100%;margin-bottom:20px;">\n            ${popup_button}\n        </div> \n        <div style="display:flex;margin-top:10px">\n            <div style="font-size:15px; font-weight:1000;margin-right:5px">Already a <span style="color:rgb(0, 154, 136);margin-right:5px">${req_plan_type} user</span>?</div>\n            <div><span class="clickHere" style="font-weight: 1000;text-decoration: underline;cursor: pointer;">Click here</span> to reload your whatsapp!</div>\n        </div>\n        `,popup.appendChild(modal_content),body.appendChild(popup),document.getElementById("close_premium_reminder_popup").addEventListener("click",function(){body.removeChild(popup),trackCloseButtonClick("premium_feature_buy_popup_close")}),document.querySelector(".clickHere").addEventListener("click",()=>{trackCloseButtonClick("premium_feature_buy_popup_reload"),location.reload()}),$(".popup-btn").on("click",function(event){let buttonType=$(this).attr("buttonType");buttonType&&buttonType.length>0&&trackButtonClick(`premium_feature_buy_popup_${buttonType}_button`)}),trackButtonView("premium_feature_buy_popup")}async function chat_link(){var chat_link_div=document.getElementsByClassName("chat_link_popup")[0];if(chat_link_div)chat_link_div.style.display="block";else{let chat_link_title=await translate("Generate WhatsApp chat link for your number"),chat_link_desc=await translate("Enter the pre-set message that you would receive when your customer clicks on the link"),modal_content_html=`\n        <span id="close_chat_link_popup" style="position: absolute;top: 6px;right: 6px;font-size: 20px;width:14px"><img  class="CtaCloseBtn" src="${pro_close_img_src}" style="width: 100%;" alt="x"></span>\n        <div class="chat_link_title">${chat_link_title}</div>\n        <div class="chat_link_desc">${chat_link_desc} (Optional)</div>\n        <textarea style="width: 460px;height: 64px;padding: 8px;" type="text" id="add_chat_message"></textarea>\n        <div id="generate_chat_link" class="popup-btn action-green-btn CtaBtn">Generate</div>\n        `,modal_content=document.createElement("div");modal_content.className="chat_link_content trial_content",modal_content.innerHTML=modal_content_html;let popup=document.createElement("div");popup.className="chat_link_popup trial_popup",popup.style.width="min(550px, 95%)",popup.appendChild(modal_content),document.querySelector("body").appendChild(popup),document.getElementById("close_chat_link_popup").addEventListener("click",function(event){document.getElementsByClassName("chat_link_popup")[0].style.display="none",trackCloseButtonClick("business_chat_link_popup_close")}),document.getElementById("generate_chat_link").addEventListener("click",function(event){if(isAdvanceFeatureAvailable()){var message=document.getElementById("add_chat_message").value,text="https://wa.me/"+my_number;""!==message&&(message=encodeURIComponent(message),text+="?text="+message),navigator.clipboard.writeText(text).then(function(){alert("Chat link generated and copied: "+text)}),document.getElementsByClassName("chat_link_popup")[0].style.display="none",trackButtonClick("generate_business_chat_link_premium")}else document.getElementsByClassName("chat_link_popup")[0].style.display="none",premium_reminder("business_chat_link","Advance");trackButtonClick("generate_business_chat_link")})}document.querySelector(".chat_link_title").innerText=await translate("Generate WhatsApp chat link for your number"),document.querySelector(".chat_link_desc").innerText=await translate("Enter the pre-set message that you would receive when your customer clicks on the link (Optional)"),trackButtonView("business_chat_link_popup")}async function review_popup(){document.querySelector("#review_popup")&&body.removeChild(document.querySelector("#review_popup"));let review_desc=await translate("Just take a second to share your positive review :)"),modal_content_html='\n        <div class="rheader" alt="">\n            <img class="pro_smile_icon" src='+pro_smile_icon+`></img>\n            <h2 id="review_popup_title">Enjoying Pro Sender?</h2>\n        </div>\n        <div class="rcenter">\n            <div class="rtop" id="review_popup_desc">${review_desc}</div>\n            <div class="rbottom">\n                <div id="notNowBtn" class="popup-btn action-white-btn CtaBtn">Not Now</div>\n                <div id="reviewBtn" class="popup-btn action-green-btn CtaBtn">\n                    <a style="width: 100%; height: 100%; display: flex; justify-content: center; align-items: center" href="" target="_blank">Review</a>\n                </div>\n            </div>\n        </div>\n        ${create_footer_html()}\n    `,modal_content=document.createElement("div");modal_content.className="review_popup_content trial_content",modal_content.style.background="#62d9c7",modal_content.innerHTML=modal_content_html;let popup=document.createElement("div");popup.className="review_popup",popup.appendChild(modal_content);var body=document.querySelector("body");body.appendChild(popup),document.querySelector("#notNowBtn").addEventListener("click",()=>{body.removeChild(popup),trackButtonClick("review_popup_not_now_button")}),document.querySelector("#reviewBtn").addEventListener("click",()=>{body.removeChild(popup),localStorage.setItem("rvisited",1),trackButtonClick("review_popup_review_button")}),trackButtonView("review_popup")}function formatDate(inputDate){const dateParts=inputDate.split("/"),day=parseInt(dateParts[1]),month=parseInt(dateParts[0])-1,year=parseInt(dateParts[2]),splittedDate=new Date(year,month,day).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}).split(" ");return`${splittedDate[0]}, ${splittedDate[2]}`}function sortDatesDescending(dateArray){return dateArray.sort(function(a,b){const datePartsA=a.date.split("/").map(Number),datePartsB=b.date.split("/").map(Number),dateA=new Date(datePartsA[2],datePartsA[0]-1,datePartsA[1]);return new Date(datePartsB[2],datePartsB[0]-1,datePartsB[1])-dateA})}function callIfNoOtherPopups(fun){const getPopupInterval=setInterval(()=>{const trialPopup=document.querySelector(".trial_popup"),successPopup=document.querySelector(".success_popup"),sidebar=document.getElementById("side"),buyAnnualPopup=document.querySelector("#buy_annual_popup");trialPopup||successPopup||buyAnnualPopup||!sidebar||(clearInterval(getPopupInterval),fun())},500)}(isAdvanceFeatureAvailable()||isExpired())&&(premiumUsageObject={...premiumUsageObject,multipleAttachment:!1,schedule:!1}),setPremiumUsageObject(),function addInject(){let script_element=document.createElement("script");script_element.setAttribute("type","text/javascript"),script_element.setAttribute("id","inject"),script_element.src=chrome.runtime.getURL("/js/proinjt.js"),script_element.onload=function(){this.parentNode.removeChild(this)},document.head.appendChild(script_element)}(),window.addEventListener("message",injectMessageListner,!1),init(),document.body.addEventListener("click",function(event){event.target.classList.contains("handle_help_btn")&&handle_help()}),document.addEventListener("click",event=>{if(document.querySelector(".trial_popup")){let popup=document.querySelectorAll(".trial_popup")[0];const isBuyAnnualPopup=popup.classList.contains("buy_annual_popup");popup.contains(event.target)||(document.body.removeChild(popup),isBuyAnnualPopup&&chrome.storage.local.set({lastShownAnnualPopup:formatToIsoDate(new Date)}))}});const howToUseData=[{image:pro_how_to_use1,content:"Click on the Extensions icons at the top right of the chrome window",index:1,hasPrev:!1,hasNext:!0},{image:pro_how_to_use2,content:"Pin the Pro Sender extension icon by clicking on the pin button ",index:2,hasPrev:!0,hasNext:!0},{image:pro_how_to_use3,content:"Start using the extension by clicking on the Pro Sender extension icon",index:3,hasPrev:!0,hasNext:!0}];function changeNavigationColor(index){0==index&&(document.querySelector(".nav_line_1").classList.contains("active_line_class")&&document.querySelector(".nav_line_1").classList.remove("active_line_class"),document.querySelector(".nav_num_2").classList.contains("active_num_class")&&document.querySelector(".nav_num_2").classList.remove("active_num_class"),document.querySelector(".nav_line_2").classList.contains("active_line_class")&&document.querySelector(".nav_line_2").classList.remove("active_line_class"),document.querySelector(".nav_num_3").classList.contains("active_num_class")&&document.querySelector(".nav_num_3").classList.remove("active_num_class")),1==index&&(document.querySelector(".nav_line_1").classList.contains("active_line_class")||document.querySelector(".nav_line_1").classList.add("active_line_class"),document.querySelector(".nav_num_2").classList.contains("active_num_class")||document.querySelector(".nav_num_2").classList.add("active_num_class"),document.querySelector(".nav_line_2").classList.contains("active_line_class")&&document.querySelector(".nav_line_2").classList.remove("active_line_class"),document.querySelector(".nav_num_3").classList.contains("active_num_class")&&document.querySelector(".nav_num_3").classList.remove("active_num_class")),2==index&&(document.querySelector(".nav_line_2").classList.contains("active_line_class")||document.querySelector(".nav_line_2").classList.add("active_line_class"),document.querySelector(".nav_num_3").classList.contains("active_num_class")||document.querySelector(".nav_num_3").classList.add("active_num_class"))}function howToUsePopup(){const parentDiv=document.createElement("div");parentDiv.className="how_to_use_popup";let currentIndex=0;const popupHtml=`\n        <div class="how_to_use_container">\n            <div class="how_to_use_header">\n                <div class="how_to_use_title">\n                    <img style="width: 50px; margin-right:10px;" src=${pro_bulb_icon} alt="" />\n                    <p>How to use</p>\n                </div>\n                <div class="how_to_use_logo">\n                    <img class="how_to_use_logo_img" src="${logo_img}"/>\n                    <img class="how_to_use_logo_text" src="${logo_text}"/>\n                </div>\n            </div>\n            <div class="how_to_use_body">\n                <div class="how_to_use_text ${1==currentIndex?"second":""}">\n                    <p class="ins_number">${howToUseData[currentIndex].index}</p>\n                    <p class="ins_text">${howToUseData[currentIndex].content}</p>\n                </div>\n                <div class="how_to_use_image">\n                    <img src=${howToUseData[currentIndex].image} alt="" />\n                </div>\n            </div>\n            <div class="how_to_use_buttons">\n                <div class="how_to_use_button prev_button CtaBtn">\n                    <img style="width: 22px" src=${pro_arrow_left} alt="" />\n                    Previous\n                </div>\n                <div class="how_to_use_button next_button CtaBtn">\n                    Next\n                    <img style="width: 22px" src=${pro_arrow_right} alt="" />\n                </div>\n                <div class="how_to_use_button navigation_close_button CtaBtn" style="display: none; padding:13px 30px;">\n                    Close\n                </div>\n            </div>\n            <div class="navigation_section">\n                <div class="nav_num nav_num_1 active_num_class">1</div>\n                <div class="nav_line nav_line_1"></div>\n                <div class="nav_num nav_num_2">2</div>\n                <div class="nav_line nav_line_2"></div>\n                <div class="nav_num nav_num_3">3</div>\n            </div>\n        </div>\n    `;parentDiv.innerHTML=popupHtml,document.body.appendChild(parentDiv),document.querySelector(".navigation_close_button").addEventListener("click",()=>{document.body.removeChild(parentDiv),chrome.storage.local.set({showHowToUsePopup:!1})}),document.querySelector(".next_button").addEventListener("click",()=>{currentIndex!=howToUseData.length-1&&(currentIndex++,changeNavigationColor(currentIndex),document.querySelector(".how_to_use_text").style.flexDirection=1==currentIndex?"row-reverse":"row",currentIndex%2==0?(document.querySelector(".how_to_use_body").style.flexDirection="row",document.querySelector(".how_to_use_popup").style.background="linear-gradient(270deg, #FFFFFF 90.23%, #009A88 100%)"):(document.querySelector(".how_to_use_body").style.flexDirection="row-reverse",document.querySelector(".how_to_use_popup").style.background="linear-gradient(90deg, #FFFFFF 90.23%, #009A88 100%)"),document.querySelector(".ins_number").innerText=howToUseData[currentIndex].index,document.querySelector(".ins_text").innerText=howToUseData[currentIndex].content,document.querySelector(".how_to_use_image img").src=howToUseData[currentIndex].image,document.querySelector(".prev_button").style.display="flex",currentIndex==howToUseData.length-1&&(document.querySelector(".next_button").style.display="none",document.querySelector(".navigation_close_button").style.display="flex"))}),document.querySelector(".prev_button").addEventListener("click",()=>{0!=currentIndex&&(currentIndex--,changeNavigationColor(currentIndex),document.querySelector(".how_to_use_text").style.flexDirection=1==currentIndex?"row-reverse":"row",currentIndex%2==0?(document.querySelector(".how_to_use_body").style.flexDirection="row",document.querySelector(".how_to_use_popup").style.background="linear-gradient(270deg, #FFFFFF 90.23%, #009A88 100%)"):(document.querySelector(".how_to_use_body").style.flexDirection="row-reverse",document.querySelector(".how_to_use_popup").style.background="linear-gradient(90deg, #FFFFFF 90.23%, #009A88 100%)"),document.querySelector(".ins_number").innerText=howToUseData[currentIndex].index,document.querySelector(".ins_text").innerText=howToUseData[currentIndex].content,document.querySelector(".how_to_use_image img").src=howToUseData[currentIndex].image,document.querySelector(".next_button").style.display="flex",document.querySelector(".navigation_close_button").style.display="none",0==currentIndex&&(document.querySelector(".prev_button").style.display="none"))})}function showHowToUsePopup(){chrome.storage.local.get(["showHowToUsePopup","no_of_visit"],res=>{let visit_count=res.no_of_visit||0;if(0==res.showHowToUsePopup)return;0==visit_count&&chrome.storage.local.set({showHowToUsePopup:!0});const getSideBarInterval=setInterval(()=>{const sidebar=document.getElementById("side"),trialPopup=document.querySelector(".trial_popup");sidebar&&!trialPopup&&(howToUsePopup(),clearInterval(getSideBarInterval))},500)})}async function buyAnnualPopup(){document.querySelector("#buy_annual_popup")&&body.removeChild(document.querySelector("#buy_annual_popup"));let{name:country_name,name_code:country_code,currency:country_currency}=location_info;country_name=Object.keys(COUNTRY_WITH_SPECIFIC_PRICING).includes(country_code)?COUNTRY_WITH_SPECIFIC_PRICING[country_code]:"international";let priceToBeShown="Advance"==plan_type?ADVANCE_SLASHED_PRICE[country_name]:BASIC_SLASHED_PRICE[country_name],pref="";"international"==country_name||"kuwait"==country_name?(pref=priceToBeShown[0],priceToBeShown=priceToBeShown.substring(1)):"india"!=country_name&&(pref=priceToBeShown.substring(0,4),priceToBeShown=priceToBeShown.substring(4));let exchangedPrice=await convertPriceToLocale(2*priceToBeShown);priceToBeShown=pref+2*priceToBeShown;const modal_content_html=`\n        <div class="buy_annual_top_section">\n            <span id="buy_annual_close_icon" class="CtaCloseBtn" style="position: absolute;top: 6px;right: 6px;font-size: 20px;width:14px"><img  class="CtaCloseBtn" src=${pro_close_img_src} style="width: 100%;" alt="x"></span>\n            <div class="buy_annual_heading">\n                <div class="buy_annual_image">\n                    <img src=${pro_man_thinking} alt="image" />\n                </div>\n                <div class="buy_annual_heading_text">\n                    <p class="buy_annual_first_line">\n                        You could save almost <span class="rupee">${"india"==country_name?"":""}</span>${priceToBeShown}!\n                        ${"international"===country_name&&"USD"!=country_currency?`<span class="converted_price_class">(~${exchangedPrice})</span>`:""}</p>\n                    <p class="buy_annual_second_line">Wondering how?</p>\n                </div>\n            </div>\n            <div class="buy_annual_advice">\n                <div class="buy_annual_advice_text">\n                    <img  style="width:25px; height:25px;" src=${pro_cross_icon_src} alt="" />\n                    <p>Youve been using the monthly plan which is overall <span style="font-weight:bold;">expensive!</span></p>\n                </div>\n                <div class="buy_annual_advice_text">\n                    <img  style="width:25px; height:25px;" src=${pro_check_icon_src} alt="" />\n                    <p>Simply buy the <span style="font-weight:bold;">Annual Plan</span> and get <span style="font-weight:bold;">2 months FREE!</span></p>\n                </div> \n            </div>\n            <div class="buy_annual_recommendation"></div>\n        </div>\n        <div class="buy_annual_timer_strip">\n            <div class="buy_annual_timer_container">\n                <div class="buy_annual_timer_img">\n                    <img src="${pro_alarm_clock}"/>\n                </div>\n                <div class="buy_annual_timer_counter">\n                    <p>\n                        Only <span class="buy_annual_counter" style="font-weight:bold;">4 days, 14 hrs, 57 sec </span>left <br /> to avail the offer\n                    </p>\n                </div>\n            </div>\n        </div>\n        <div class="buy_annual_button_section">\n            <a href= target="_blank" class="buy-annual-popup-btn" buttonType="${plan_type.toLowerCase()}_annual">\n                <span class="annual_button_top_span"><img src="${pro_yellow_star}" style="width:15px;"/>Save 40% with</span>\n                <span style="font-weight:bold;">${plan_type} Annual</span>\n            </a>\n        </div>\n        ${create_footer_html()}\n    `;let modal_content=document.createElement("div");modal_content.className="buy_annual_popup_content trial_content",modal_content.style.background="#d3d3d3",modal_content.innerHTML=modal_content_html;let popup=document.createElement("div");popup.className="buy_annual_popup trial_popup",popup.id="buy_annual_popup",popup.appendChild(modal_content);let body=document.querySelector("body");body.appendChild(popup),document.getElementById("buy_annual_close_icon").addEventListener("click",()=>{body.removeChild(popup),chrome.storage.local.set({lastShownAnnualPopup:formatToIsoDate(new Date)}),trackCloseButtonClick("buy_annual_popup_close")}),$(".buy-annual-popup-btn").on("click",function(event){let buttonType=$(this).attr("buttonType");buttonType&&buttonType.length>0&&trackButtonClick(`buy_annual_popup_${buttonType}_button`)}),changeCounterTime(),handleAnnualPopupCounter(),trackButtonView("buy_annual_popup")}function changeCounterTime(getCounterInterval){const diff=new Date(expiry_date)-new Date,days=Math.floor(diff/864e5);let counterText="";days>0&&(counterText+=`${days} days, `),counterText+=`${Math.floor(diff%864e5/36e5)} hrs, ${Math.floor(diff%36e5/6e4)} min, ${Math.floor(diff%6e4/1e3)} sec `;const buyAnnualCouter=document.querySelector(".buy_annual_counter");buyAnnualCouter?(buyAnnualCouter.innerText=counterText,diff<=0&&getCounterInterval&&clearInterval(getCounterInterval)):clearInterval(getCounterInterval)}function handleAnnualPopupCounter(){const getCounterInterval=setInterval(()=>{changeCounterTime(getCounterInterval)},1e3)}function getMonthDifference(date1,date2){const[month1,year1]=date1.split(", "),[month2,year2]=date2.split(", ");return 12*(parseInt(year2)-parseInt(year1))+(getMonthIndex(month2)-getMonthIndex(month1))}callIfNoOtherPopups(showHowToUsePopup);const monthNames=null;function getMonthIndex(month){return monthNames.indexOf(month)}function formatToIsoDate(date){return`${date.getFullYear()}-${date.getMonth()+1}-${date.getDate()}`}function dateDiffInDays(date1,date2){if(!date1||!date2)return NaN;const[year1,month1,day1]=date1.split("-").map(Number),[year2,month2,day2]=date2.split("-").map(Number),d1=new Date(year1,month1-1,day1),d2=new Date(year2,month2-1,day2),diffTime=Math.abs(d2-d1);return Math.ceil(diffTime/864e5)}async function updateReminderPopup(){if(!SHOW_UPDATE_REMINDER_POPUP)return;document.querySelector("#update_reminder_popup")&&document.querySelector("body").removeChild(document.querySelector("#update_reminder_popup"));let modal_content_html=`\n           <div class="rheader">\n            <h2 id="update_popup_title">New Version Available</h2>\n        </div>\n        <div class="rcenter">\n            <div class="rtop" id="update_popup_desc">${await translate("You can either restart your Chrome to update or you can go to manage Chrome extension and update it.")}</div>\n            <div class="rbottom">\n                <a href="" target="_blank">\n                    <div id="okBtn" class="popup-btn action-green-btn CtaBtn">Update</div>\n                </a>\n            </div>\n        </div>\n        ${create_footer_html()}\n    `,modal_content=document.createElement("div");modal_content.className="update_reminder_popup_content trial_content",modal_content.style.background="#62d9c7",modal_content.style.zIndex="100",modal_content.style.width="60%",modal_content.innerHTML=modal_content_html,modal_content.appendChild($($.parseHTML('<span id="close_update" style="position: absolute;top: 12px;right: 12px;font-size: 20px;width:14px"><img class="CtaCloseBtn" src="'+pro_close_img_src+'" style="width: 100%;" alt="x"></span>'))[0]);let popup=document.createElement("div");popup.className="update_reminder_popup",popup.id="update_reminder_popup",popup.style.height="100%",popup.style.display="flex",popup.appendChild(modal_content),document.querySelector("body").appendChild(popup),document.querySelector("#okBtn").addEventListener("click",()=>{document.querySelector("body").removeChild(popup)}),document.getElementById("close_update").addEventListener("click",function(event){document.querySelector("body").removeChild(popup)}),document.querySelector("#closePopupBtn").addEventListener("click",()=>{document.querySelector("body").removeChild(popup)})}function getDocumentElement(key,selectAll=!1){try{if(DOCUMENT_ELEMENT_SELECTORS[key])for(const className of DOCUMENT_ELEMENT_SELECTORS[key]){const element=selectAll?document.querySelectorAll(className):document.querySelector(className);if(element)return element}else console.log("Selector not exists:",key)}catch(err){console.log("Error while finding document element",err)}return null}async function fetchConfigData(){try{const response=await fetch(url),jsonData=await response.json(),allConfigData=jsonData.data;if(allConfigData&&Array.isArray(allConfigData)){const configMap=createConfigMap(allConfigData);loadConfigData(configMap),chrome.storage.local.get(["CONFIG_DATA"],res=>{chrome.storage.local.set({CONFIG_DATA:configMap})})}else console.log("Config data not found. Api response:",jsonData)}catch(err){console.log("Error while fetching config data:",err)}}function createConfigMap(configArray){const configMap={};return configArray.forEach(item=>{item.name&&null!==item.data&&(configMap[item.name]=item.data)}),configMap}function loadConfigData(configMap){configMap.TRIAL_FEATURES&&(TRIAL_FEATURES=[...configMap.TRIAL_FEATURES]),configMap.PREMIUM_FEATURES&&(PREMIUM_FEATURES=[...configMap.PREMIUM_FEATURES]),configMap.HELP_MESSAGES&&(HELP_MESSAGES={...HELP_MESSAGES}),configMap.PRICING_DATA&&(PRICING_DATA={...configMap.PRICING_DATA}),configMap.PREMIUM_REMINDER&&(PREMIUM_REMINDER={...configMap.PREMIUM_REMINDER}),configMap.DOCUMENT_ELEMENT_SELECTORS&&(DOCUMENT_ELEMENT_SELECTORS={...configMap.DOCUMENT_ELEMENT_SELECTORS}),configMap.FAQS&&(FAQS={...configMap.FAQS}),configMap.RUNTIME_CONFIG&&(RUNTIME_CONFIG={...configMap.RUNTIME_CONFIG},RUNTIME_CONFIG.reloadInject&&window.dispatchEvent(new CustomEvent("PROS::init",{detail:{useOldMethod:RUNTIME_CONFIG.useOldInjectMethod}})))}var ban_text_detected=!1;function detectBanText(){if(ban_text_detected)return;let banMessages=["verify your phone number","you will need to verify your phone number","You have been logged out. To log back in, you will need to verify your phone number.","            ,       ","Voc foi desconectado. Para fazer login novamente, ser necessrio verificar seu nmero de telefone.","Has cerrado sesin. Para volver a iniciar sesin, debers verificar tu nmero de telfono."];for(const message of banMessages)(document.body.innerText.includes(message)||document.body.innerText.toLowerCase().includes(message.toLocaleLowerCase()))&&(trackSystemEvent("banned_text",banMessages),ban_text_detected=!0)}async function messageCountOverPopup(){let{name:country_name,name_code:country_code,currency:country_currency}=location_info;country_name=Object.keys(COUNTRY_WITH_SPECIFIC_PRICING).includes(country_code)?COUNTRY_WITH_SPECIFIC_PRICING[country_code]:"international";let body=document.querySelector("body"),popup=document.createElement("div"),modal_content=document.createElement("div"),popup_button=getPremiumReminderButton("Premium");document.querySelector(".premium_reminder_popup")&&body.removeChild(document.querySelector(".premium_reminder_popup"));let remaining_count=0,total_count=0;await new Promise(resolve=>{chrome.storage.local.get(["freeTrialExpiredUserData"],function(res){const freeTrialExpiredUserData=res.freeTrialExpiredUserData;freeTrialExpiredUserData&&null!=freeTrialExpiredUserData.sent_count&&null!=freeTrialExpiredUserData.total_count&&(remaining_count=freeTrialExpiredUserData.total_count-freeTrialExpiredUserData.sent_count,total_count=freeTrialExpiredUserData.total_count),resolve()})}),popup.className="premium_reminder_popup trial_popup",modal_content.className="premium_reminder_content trial_content",modal_content.style.background="#d5cd2f",modal_content.innerHTML=`\n        <span id="close_premium_reminder_popup">\n            <img class="CtaCloseBtn" src="${pro_close_img_src}" alt="x">\n        </span>\n        <div class="premium_reminder_popup_title">\n            <span class="oops_icon"></span>Oops!\n        </div>\n        <div class="reminder_title">\n            You have ${remaining_count} of daily ${total_count} messages remaining\n        </div>\n        <div class="reminder_description">\n            ${await translate("Please buy <<Premium>> to send unlimited messages!")}\n        </div>\n        <div style="display:flex;justify-content:center;gap:20px;width:100%;margin-bottom:20px;">\n            ${popup_button}\n        </div> \n        <div style="display:flex;justify-content:center;align-items:center;gap:5px;">\n            <img src=${large_logo_img} style="width:25px;" />\n            <span style="font-weight:bold;">Pro Sender</span>\n        </div>\n        `,popup.appendChild(modal_content),body.appendChild(popup),document.getElementById("close_premium_reminder_popup").addEventListener("click",function(){body.removeChild(popup),trackCloseButtonClick("premium_feature_buy_popup_close")}),$(".popup-btn").on("click",function(event){let buttonType=$(this).attr("buttonType");buttonType&&buttonType.length>0&&trackButtonClick(`premium_feature_buy_popup_${buttonType}_button`)}),trackButtonView("premium_feature_buy_popup")}function showTooltip({elementParentClass,text,positionTop,positionBottom,positionLeft,positionRight}){const parentElement=document.querySelector(elementParentClass),tooltip=document.createElement("div");tooltip.className="tooltip_main_container",positionTop&&(tooltip.style.top=positionTop),positionBottom&&(tooltip.style.bottom=positionBottom),positionLeft&&(tooltip.style.left=positionLeft),positionRight&&(tooltip.style.right=positionRight),tooltip.innerHTML=`\n        <div>\n            ${text}\n        </div>\n        <div class="tooltip_arrow"></div>\n    `,parentElement.appendChild(tooltip)}function removeTooltip(){const tooltip=document.querySelector(".tooltip_main_container");tooltip&&tooltip.remove()}function handleShowTooltip(element){const parentElement=document.querySelector(element.query);parentElement&&(parentElement.addEventListener("mouseover",()=>{showTooltip({elementParentClass:element.query,text:element.text,positionTop:element.top,positionLeft:element.left,positionRight:element.right,positionBottom:element.bottom})}),parentElement.addEventListener("mouseout",()=>{removeTooltip()}))}let chatbotProcessedMessages=new Set,chatbotLastReplyTime={};function processChatbotMessageFromStore(msg){try{if(!msg.body||0===msg.body.trim().length)return;const senderInfo={number:msg.from,name:msg.senderName,isGroup:msg.isGroupMsg};processChatbotMessage(msg.body,senderInfo)}catch(error){console.error(" Error processing message from Store:",error)}}function processPotentialChatbotMessage(node){try{const messageElement=node.closest('[data-testid="msg-container"]')||node.closest('[role="article"]');if(!messageElement)return;if(messageElement.classList.contains("message-out")||messageElement.classList.contains("msg-dsl")&&messageElement.querySelector('[data-testid="msg-time"]')?.closest(".message-out"))return;const messageText=extractMessageText(messageElement);if(!messageText||0===messageText.trim().length)return;const messageId=generateMessageId(messageElement);if(chatbotProcessedMessages.has(messageId))return;chatbotProcessedMessages.add(messageId);const senderInfo=extractSenderInfo(messageElement);if(!senderInfo)return;processChatbotMessage(messageText,senderInfo)}catch(error){console.error(" Error processing potential chatbot message:",error),console.error("   Stack:",error.stack)}}function extractMessageText(messageElement){try{const textSelectors=[".selectable-text.copyable-text",'[data-testid="msg-text"]',".message-text",".ql-editor"];for(const selector of textSelectors){const textElement=messageElement.querySelector(selector);if(textElement){return textElement.innerText||textElement.textContent}}return messageElement.innerText||messageElement.textContent}catch(error){return console.error(" Error extracting message text:",error),null}}function generateMessageId(messageElement){try{const timeElement=messageElement.querySelector('[data-testid="msg-time"]'),timestamp=timeElement?.getAttribute("data-timestamp")||timeElement?.innerText||Date.now();return`${timestamp}_${extractMessageText(messageElement).substring(0,20)}`}catch(error){return`msg_${Date.now()}_${Math.random()}`}}function extractSenderInfo(messageElement){try{const convMsgDiv=getDocumentElement("conversation_message_div");if(!convMsgDiv||!convMsgDiv.dataset.id)return null;const chatId=convMsgDiv.dataset.id,isGroup=chatId.includes("@g.us"),senderNameElement=messageElement.querySelector(".copyable-text"),senderName=senderNameElement?.innerText||"Unknown",number=chatId.split("_")[1]?.replace("@c.us","").replace("@g.us","");return{name:senderName,number,isGroup,chatId}}catch(error){return console.error(" Error extracting sender info:",error),null}}function processChatbotMessage(messageText,senderInfo){chrome.storage.local.get(["chatbotSettings"],async result=>{try{const chatbotSettings=result.chatbotSettings;if(!chatbotSettings||!chatbotSettings.enabled)return;if(!isAdvanceFeatureAvailable())return;const rules=chatbotSettings.rules||[];if(0===rules.length)return;const matchingRule=findMatchingRule(messageText,rules);if(!matchingRule)return;if(!canSendReply(senderInfo.number))return;await sendChatbotReply(matchingRule.response,senderInfo)}catch(error){console.error("   Error processing chatbot message:",error),console.error("     Stack:",error.stack)}})}function findMatchingRule(messageText,rules){for(const rule of rules){const keyword=rule.keyword,caseSensitive=rule.caseSensitive||!1,textToCompare=(rule.exactMatch,caseSensitive?messageText:messageText.toLowerCase()),keywordList=keyword.split(",").map(k=>k.trim());let isMatch=!1;for(const kw of keywordList){const keywordToCompare=caseSensitive?kw:kw.toLowerCase();if(isMatch=textToCompare.trim()===keywordToCompare.trim(),isMatch)return rule}}return null}function canSendReply(contactNumber){const lastReplyTime=chatbotLastReplyTime[contactNumber]||0;return!(Date.now()-lastReplyTime<3e4)}async function sendChatbotReply(replyText,senderInfo){try{chatbotLastReplyTime[senderInfo.number]=Date.now();let chatId=senderInfo.number;chatId.includes("@")||(chatId=`${chatId}@c.us`),window.dispatchEvent(new CustomEvent("PROS::chatbot-typing-status",{detail:{chatId,isTyping:!0}}));const delayMs=1e3+1e4*Math.random();await new Promise(resolve=>setTimeout(resolve,delayMs)),window.dispatchEvent(new CustomEvent("PROS::chatbot-typing-status",{detail:{chatId,isTyping:!1}})),window.dispatchEvent(new CustomEvent("PROS::chatbot-send-reply",{detail:{chatId,message:replyText,isGroup:senderInfo.isGroup}})),updateChatbotReplyStats()}catch(error){console.error(" Error sending chatbot reply:",error)}}function updateChatbotReplyStats(){chrome.storage.local.get(["chatbotSettings"],result=>{try{let chatbotSettings=result.chatbotSettings||{enabled:!1,rules:[],repliesSent:0};chatbotSettings.repliesSent=(chatbotSettings.repliesSent||0)+1,chrome.storage.local.set({chatbotSettings}),chrome.runtime.sendMessage({type:"chatbot_stats_updated",repliesSent:chatbotSettings.repliesSent}).catch(()=>{})}catch(error){console.error(" Error updating chatbot stats:",error)}})}function generateUUID(){const length=Math.floor(7*Math.random())+10;return"x".repeat(length).replace(/[x]/g,function(c){return(16*Math.random()|0).toString(16)})}function appendUniqueIdentifier(message,caption){const identifier=`\n\n[ID: ${generateUUID()}]`;return{message:message?message+identifier:null,caption:caption?caption+identifier:null}}async function isUniqueIdentifierEnabled(){return new Promise(resolve=>{const checkbox=document.getElementById("addUniqueIdentifier");checkbox&&checkbox.checked?resolve(!0):chrome.storage.local.get("addUniqueIdentifier",result=>{resolve(!0===result.addUniqueIdentifier)})})}